# Redis MurKir Security v2.0 - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

## üõ°Ô∏è –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**Redis MurKir Security v2.0** - —ç—Ç–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç—ã –≤–µ–±-—Å–∞–π—Ç–æ–≤ –æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–æ—Ç–æ–≤, —Å–∫—Ä–µ–ø–µ—Ä–æ–≤ –∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞. –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –∞–Ω–∞–ª–∏–∑–∏—Ä—É—è –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –∏ –±–ª–æ–∫–∏—Ä—É—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.

## üéØ –û—Ç –∫–æ–≥–æ –∑–∞—â–∏—â–∞–µ—Ç?

### ‚úÖ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç:**

**1. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–æ—Ç—ã:**
- cURL, wget, Python requests
- Selenium WebDriver, Puppeteer
- Headless –±—Ä–∞—É–∑–µ—Ä—ã (Chrome --headless)
- –°–∫—Ä–∏–ø—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ —Å–∫—Ä–µ–π–ø–∏–Ω–≥–∞

**2. –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫:**
- DDoS –∞—Ç–∞–∫–∏ –º–∞–ª–æ–π –∏ —Å—Ä–µ–¥–Ω–µ–π –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏
- –ë—Ä—É—Ç—Ñ–æ—Ä—Å –∞—Ç–∞–∫–∏ –Ω–∞ —Ñ–æ—Ä–º—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∞–º
- –ù–∞–∫—Ä—É—Ç–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤

**3. –ù–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫–∞–Ω–µ—Ä—ã:**
- –°–∫–∞–Ω–µ—Ä—ã —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- SEO-–±–æ—Ç—ã (–∫—Ä–æ–º–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö)
- –ö–æ–Ω—Ç–µ–Ω—Ç-–ø–∞—Ä—Å–µ—Ä—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∏ —Ü–µ–Ω

**4. –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –°–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è (>50-200 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω)
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ User-Agent —Å –æ–¥–Ω–æ–≥–æ IP

### ‚ùå **–ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç (–±–µ–∑–æ–ø–∞—Å–Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç):**

**1. –õ–µ–≥–∏—Ç–∏–º–Ω—ã–µ –ø–æ–∏—Å–∫–æ–≤—ã–µ –±–æ—Ç—ã:**
- Googlebot, Bingbot, Yandexbot
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ rDNS + User-Agent
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ whitelisting

**2. –û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:**
- –ù–∞—Å—Ç–æ—è—â–∏–µ –±—Ä–∞—É–∑–µ—Ä—ã (Chrome, Firefox, Safari)
- –ú–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã –Ω–∞ –æ–¥–Ω–æ–º IP

**3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–∏—Å—ã:**
- Uptime Robot, Pingdom, StatusCake
- CDN —Å–µ—Ä–≤–∏—Å—ã (Cloudflare, Fastly)
- –ê—Ä—Ö–∏–≤—ã (Archive.org)

## üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞?

### **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞:**

**1. –£—Ä–æ–≤–µ–Ω—å IP –∞–Ω–∞–ª–∏–∑–∞:**
```
–ü–æ—Å–µ—Ç–∏—Ç–µ–ª—å ‚Üí –ê–Ω–∞–ª–∏–∑ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ ‚Üí –†–µ—à–µ–Ω–∏–µ
```

**2. –£—Ä–æ–≤–µ–Ω—å —Ö–µ—à-–∞–Ω–∞–ª–∏–∑–∞ (v2.0):**
```
–ë—Ä–∞—É–∑–µ—Ä–Ω—ã–π –æ—Ç–ø–µ—á–∞—Ç–æ–∫ ‚Üí –£–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ö–µ—à ‚Üí –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è ‚Üí –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞
```

**3. –£—Ä–æ–≤–µ–Ω—å —Å–µ—Å—Å–∏–π/cookies:**
```
Cookie –ø—Ä–æ–≤–µ—Ä–∫–∞ ‚Üí –°–µ—Å—Å–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Üí –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ ‚Üí –†–µ—à–µ–Ω–∏–µ
```

### **–ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π:**

```
1. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã ‚Üí –ü–†–û–ü–£–°–ö
2. –ü–æ–∏—Å–∫–æ–≤—ã–µ –±–æ—Ç—ã ‚Üí –ü–†–û–í–ï–†–ö–ê rDNS ‚Üí –ü–†–û–ü–£–°–ö/–ë–õ–û–ö
3. –•–µ—à –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω? ‚Üí –ë–õ–û–ö
4. IP/–°–µ—Å—Å–∏—è/Cookie –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã? ‚Üí –ë–õ–û–ö
5. –í–∞–ª–∏–¥–Ω—ã–π cookie? ‚Üí –ê–ù–ê–õ–ò–ó –ü–û–í–ï–î–ï–ù–ò–Ø ‚Üí –†–ï–®–ï–ù–ò–ï
6. –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –°–û–ó–î–ê–ù–ò–ï COOKIE ‚Üí –ü–†–û–ü–£–°–ö
```

### **–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤–∫–ª—é—á–∞–µ—Ç:**

- **–°–∫–æ—Ä–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤** (–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É)
- **–†–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤** (–±–æ—Ç-–ø–∞—Ç—Ç–µ—Ä–Ω—ã)
- **–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü** (–º–æ–Ω–æ—Ç–æ–Ω–Ω–æ—Å—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏—è)
- **HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏** (–ø–æ–ª–Ω–æ—Ç–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å)
- **User-Agent –∞–Ω–∞–ª–∏–∑** (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã)
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤** –Ω–∞ IP

## üîå –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∞—Ç—å?

### **1. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã:**

**PHP –≤–µ—Ä—Å–∏–∏:**
- ‚úÖ **PHP 7.4+** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- ‚úÖ **PHP 8.0+** (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)
- ‚úÖ **PHP 8.1, 8.2, 8.3** (–ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞)
- ‚ùå PHP 7.3 –∏ –Ω–∏–∂–µ (–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- **Redis 4.0+** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- **php-redis —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- **Sessions –ø–æ–¥–¥–µ—Ä–∂–∫–∞** (–≤–∫–ª—é—á–µ–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:**
```php
<?php
// –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —ç—Ç–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
echo "PHP –≤–µ—Ä—Å–∏—è: " . PHP_VERSION . "\n";
echo "Redis —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ: " . (extension_loaded('redis') ? '–î–ê' : '–ù–ï–¢') . "\n";
echo "Sessions: " . (function_exists('session_start') ? '–î–ê' : '–ù–ï–¢') . "\n";
?>
```

### **2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Redis:**

**Ubuntu/Debian:**
```bash
sudo apt update
sudo apt install redis-server php-redis
sudo systemctl start redis
sudo systemctl enable redis
```

**CentOS/RHEL:**
```bash
sudo yum install redis php-redis
sudo systemctl start redis
sudo systemctl enable redis
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ Redis:**
```bash
redis-cli ping
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: PONG
```

### **3. –ë–∞–∑–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**

**–°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã:**
```
/your-site/bot_protection/
‚îú‚îÄ‚îÄ inline_check.php          # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –∑–∞—â–∏—Ç—ã
‚îú‚îÄ‚îÄ redis-admin.php           # –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞  
‚îú‚îÄ‚îÄ redis_test.php            # –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îî‚îÄ‚îÄ README.txt                # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

**–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–π PHP —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
```php
<?php
// –í —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –¥–æ –ª—é–±–æ–≥–æ –≤—ã–≤–æ–¥–∞
require_once '/path/to/bot_protection/inline_check.php';

try {
    $protection = new RedisBotProtectionWithSessions(
        '127.0.0.1',    // Redis host
        6379,           // Redis port  
        null,           // Redis password (–µ—Å–ª–∏ –µ—Å—Ç—å)
        0               // Redis database (–æ–±—ã—á–Ω–æ 0)
    );
    
    $protection->protect();
    
} catch (Exception $e) {
    error_log("Bot protection error: " . $e->getMessage());
    // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É –±–µ–∑ –∑–∞—â–∏—Ç—ã –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏
}

// –í–∞—à –æ–±—ã—á–Ω—ã–π –∫–æ–¥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
?>
<!DOCTYPE html>
<html>
...
```

### **4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**

**–ß–µ—Ä–µ–∑ .htaccess (–ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±):**
```apache
# –î–æ–±–∞–≤—å—Ç–µ –≤ .htaccess
php_value auto_prepend_file "/full/path/to/bot_protection/inline_check.php"
```

**–ß–µ—Ä–µ–∑ PHP-FPM pool (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è VPS/–≤—ã–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤):**
```ini
# –î–æ–±–∞–≤—å—Ç–µ –≤ /etc/php/7.4/fpm/pool.d/your-site.conf
# –∏–ª–∏ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π pool –∫–æ–Ω—Ñ–∏–≥

; –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç –±–æ—Ç–æ–≤ —Å —Å–µ—Å—Å–∏—è–º–∏
php_admin_value[auto_prepend_file] = "/home/user/site/bot_protection/inline_check.php"

# –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ PHP-FPM:
# sudo systemctl reload php7.4-fpm
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ PHP-FPM –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ (–±—ã—Å—Ç—Ä–µ–µ)
- ‚úÖ –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç .htaccess
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞–º–∏ (Nginx + PHP-FPM)
- ‚úÖ –ë–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ (—Å–∏—Å—Ç–µ–º–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å)

**–ß–µ—Ä–µ–∑ php.ini (–≥–ª–æ–±–∞–ª—å–Ω–æ –¥–ª—è –≤—Å–µ—Ö —Å–∞–π—Ç–æ–≤):**
```ini
; –î–æ–±–∞–≤—å—Ç–µ –≤ php.ini (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ - –¥–ª—è –≤—Å–µ—Ö —Å–∞–π—Ç–æ–≤!)
auto_prepend_file = "/full/path/to/bot_protection/inline_check.php"
```

**–ß–µ—Ä–µ–∑ WordPress (functions.php):**
```php
// –î–æ–±–∞–≤—å—Ç–µ –≤ functions.php —Ç–µ–º—ã
add_action('init', function() {
    if (!is_admin()) {
        require_once '/path/to/bot_protection/inline_check.php';
        
        try {
            $protection = new RedisBotProtectionWithSessions();
            $protection->protect();
        } catch (Exception $e) {
            error_log("Bot protection error: " . $e->getMessage());
        }
    }
});
```

**–ß–µ—Ä–µ–∑ Nginx + PHP-FPM (—Å–µ—Ä–≤–µ—Ä–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å):**
```nginx
# –í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx location –±–ª–æ–∫–∞
location ~ \.php$ {
    fastcgi_pass unix:/var/run/php/php7.4-fpm.sock;
    fastcgi_param PHP_VALUE "auto_prepend_file=/home/user/site/bot_protection/inline_check.php";
    # –æ—Å—Ç–∞–ª—å–Ω—ã–µ fastcgi –ø–∞—Ä–∞–º–µ—Ç—Ä—ã...
}
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**

**1. –°–º–µ–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á:**
```php
private $secretKey = '–≤–∞—à_—É–Ω–∏–∫–∞–ª—å–Ω—ã–π_–∫–ª—é—á_–º–∏–Ω–∏–º—É–º_32_—Å–∏–º–≤–æ–ª–∞_2025';
```

**2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Redis –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**
```php
$protection = new RedisBotProtectionWithSessions(
    'localhost',        // –∏–ª–∏ IP –≤–∞—à–µ–≥–æ Redis —Å–µ—Ä–≤–µ—Ä–∞
    6379,              // –ø–æ—Ä—Ç Redis  
    'password',        // –ø–∞—Ä–æ–ª—å Redis (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
    0                  // –Ω–æ–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
);
```

### **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**

**–ú—è–≥–∫–∏–π —Ä–µ–∂–∏–º (–¥–ª—è —Å–∞–π—Ç–æ–≤ —Å –≤—ã—Å–æ–∫–∏–º —Ç—Ä–∞—Ñ–∏–∫–æ–º):**
```php
// –í analyzeUserHashBehavior() –∏–∑–º–µ–Ω–∏—Ç–µ:
$blockThreshold = $isMobile ? 40 : 30;  // –≤–º–µ—Å—Ç–æ 25:12

// –í ttlSettings –∏–∑–º–µ–Ω–∏—Ç–µ:
'ip_blocked' => 600,                    // 10 –º–∏–Ω—É—Ç –≤–º–µ—Å—Ç–æ 30
'user_hash_blocked' => 1800,            // 30 –º–∏–Ω—É—Ç –≤–º–µ—Å—Ç–æ 2 —á–∞—Å–æ–≤
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### **–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:**
```
https://your-site.com/bot_protection/redis-admin.php
```
**–§—É–Ω–∫—Ü–∏–∏:**
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP/—Ö–µ—à–µ–π
- –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### **–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞:**
```
https://your-site.com/bot_protection/redis_test.php  
```
**–§—É–Ω–∫—Ü–∏–∏:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∑–∞—â–∏—Ç—ã
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- Debug –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f /var/log/apache2/error.log | grep "blocked"

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Redis
redis-cli keys "bot_protection:*" | wc -l
```

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### **–ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è:**

**1. "Redis connection failed"**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å Redis
sudo systemctl status redis
redis-cli ping

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ PHP —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
php -m | grep redis
```

**2. "–ë–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –æ–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏"**
```php
// –£–≤–µ–ª–∏—á—å—Ç–µ –ø–æ—Ä–æ–≥–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
$blockThreshold = $isMobile ? 40 : 30;
'ip_blocked' => 300,  // 5 –º–∏–Ω—É—Ç –≤–º–µ—Å—Ç–æ 30
```

**3. "–ë–æ—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –∑–∞—â–∏—Ç—É"**
```php
// –£–º–µ–Ω—å—à–∏—Ç–µ –ø–æ—Ä–æ–≥–∏
$blockThreshold = $isMobile ? 15 : 10;
if ($trackingData['requests'] < 3) // –≤–º–µ—Å—Ç–æ 5
```

**4. "–ú–æ–±–∏–ª—å–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã –±–ª–æ–∫–∏—Ä—É—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞"**
```php
// ‚úÖ –£–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ v2.0!
// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è lastOctet IP –¥–ª—è —Ä–∞–∑–ª–∏—á–∏—è –±—Ä–∞—É–∑–µ—Ä–æ–≤
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### **–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ:**
- 1 CPU —è–¥—Ä–æ
- 512 MB RAM  
- 100 MB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞
- Redis 50 MB RAM

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ:**
- 2+ CPU —è–¥—Ä–∞
- 2+ GB RAM
- 1 GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞  
- Redis 200+ MB RAM

### **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º—É:**

**–ü—Ä–∏ 1000 –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π/—á–∞—Å:**
- Redis –ø–∞–º—è—Ç—å: ~50-100 MB
- PHP –ø–∞–º—è—Ç—å: +5-10 MB –Ω–∞ –∑–∞–ø—Ä–æ—Å
- CPU –Ω–∞–≥—Ä—É–∑–∫–∞: +5-15%
- –ó–∞–¥–µ—Ä–∂–∫–∞ –æ—Ç–≤–µ—Ç–∞: +5-50 –º—Å

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –í–∫–ª—é—á–∏—Ç–µ Redis persistence
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ TTL –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º—è–≥–∫–∏–µ —Ä–µ–∂–∏–º—ã –¥–ª—è –≤—ã—Å–æ–∫–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞

## üõ†Ô∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ CMS

### **WordPress:**
```php
// functions.php
add_action('template_redirect', function() {
    require_once '/path/to/inline_check.php';
    $protection = new RedisBotProtectionWithSessions();
    $protection->protect();
});
```

### **Laravel:**
```php
// Middleware
php artisan make:middleware BotProtection

// –í BotProtection.php
public function handle($request, Closure $next) {
    require_once '/path/to/inline_check.php';
    $protection = new RedisBotProtectionWithSessions();
    $protection->protect();
    return $next($request);
}
```

### **Drupal:**
```php
// settings.php
$settings['container_yamls'][] = '/path/to/bot_protection_services.yml';
// –ò–ª–∏ —á–µ—Ä–µ–∑ hook_init()
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### **–ß—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –ù–ï –∑–∞–º–µ–Ω—è–µ—Ç:**
- ‚ùå Firewall (iptables/ufw)
- ‚ùå DDoS –∑–∞—â–∏—Ç—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞  
- ‚ùå SSL/TLS —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- ‚ùå –ê–Ω—Ç–∏–≤–∏—Ä—É—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚ùå Backup —Å—Ç—Ä–∞—Ç–µ–≥–∏—é

### **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ secretKey
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Redis –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
- –î–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫

## üìã –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### **–î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–∞–π—Ç–æ–≤:**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
2. –°–º–µ–Ω–∏—Ç–µ secretKey –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π
3. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ 1-2 –Ω–µ–¥–µ–ª–∏
4. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### **–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏!**

**–í–µ—Ä—Å–∏—è:** v2.0  
**–°—Ç–∞—Ç—É—Å:** –°—Ç–∞–±–∏–ª—å–Ω–∞—è  
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** PHP 7.4+ / Redis 4.0+  
**–õ–∏—Ü–µ–Ω–∑–∏—è:** –ü—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω–∞—è  
**–ü–æ–¥–¥–µ—Ä–∂–∫–∞:** –ß–µ—Ä–µ–∑ –ª–æ–≥–∏ –∏ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å

Redis Bot Protection v2.0 - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
===========================================================

üéØ –û–°–ù–û–í–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ)

1. –°–¢–†–û–ì–û–°–¢–¨ –ë–õ–û–ö–ò–†–û–í–ö–ò –•–ï–®–ï–ô
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–ù–∞–π—Ç–∏ –≤ analyzeUserHashBehavior():
$blockThreshold = $isMobile ? 25 : 12;

–í–∞—Ä–∏–∞–Ω—Ç—ã –∑–∞–º–µ–Ω—ã:
‚Ä¢ –ú—è–≥–∫–æ:     $blockThreshold = $isMobile ? 40 : 30;
‚Ä¢ –°—Ä–µ–¥–Ω–µ:    $blockThreshold = $isMobile ? 35 : 20;
‚Ä¢ –°—Ç—Ä–æ–≥–æ:    $blockThreshold = $isMobile ? 15 : 8;

2. –í–†–ï–ú–Ø –ë–õ–û–ö–ò–†–û–í–ö–ò (–≤ ttlSettings)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
'ip_blocked' => 1800,                    // IP –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
'user_hash_blocked' => 7200,             // –•–µ—à –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞  
'session_blocked' => 21600,              // –°–µ—Å—Å–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
'cookie_blocked' => 14400,               // Cookie –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

–í–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è –º—è–≥–∫–æ–π –∑–∞—â–∏—Ç—ã:
‚Ä¢ 'ip_blocked' => 300,                   // 5 –º–∏–Ω—É—Ç
‚Ä¢ 'user_hash_blocked' => 1800,           // 30 –º–∏–Ω—É—Ç
‚Ä¢ 'session_blocked' => 3600,             // 1 —á–∞—Å

3. –ü–†–ò–û–†–ò–¢–ï–¢ –•–ï–®–ê –ù–ê–î IP
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–í –º–µ—Ç–æ–¥–µ protect() –Ω–∞–π—Ç–∏:
} else {
    $this->blockIP($ip);
}

–ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞:
} else {
    // –ù–ï –±–ª–æ–∫–∏—Ä—É–µ–º IP, —Ç–æ–ª—å–∫–æ —Ö–µ—à
}

4. –ú–û–ë–ò–õ–¨–ù–´–ï –•–ï–®–ò (–ò–°–ü–†–ê–í–õ–ï–ù–û!)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–í generateUserHash() –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
if ($this->isMobileDevice($userAgent)) {
    $ipParts = explode('.', $ip);
    $lastOctet = end($ipParts);
    $fingerprint .= '|' . $lastOctet;
} else {
    $fingerprint .= '|' . $ip;
}

‚úÖ –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ - —Ä–∞–∑–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã = —Ä–∞–∑–Ω—ã–µ —Ö–µ—à–∏!

5. –ú–ò–ù–ò–ú–£–ú –ó–ê–ü–†–û–°–û–í –î–õ–Ø –ê–ù–ê–õ–ò–ó–ê
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–í analyzeUserHashBehavior() –Ω–∞–π—Ç–∏:
if ($trackingData['requests'] < 5) {

–í–∞—Ä–∏–∞–Ω—Ç—ã:
‚Ä¢ –ë—ã—Å—Ç—Ä–æ:    if ($trackingData['requests'] < 3) {
‚Ä¢ –°—Ä–µ–¥–Ω–µ:    if ($trackingData['requests'] < 8) {
‚Ä¢ –ú–µ–¥–ª–µ–Ω–Ω–æ:  if ($trackingData['requests'] < 15) {

–í shouldAnalyzeIP() –Ω–∞–π—Ç–∏:
if ($requests > 5) {

–í–∞—Ä–∏–∞–Ω—Ç—ã:
‚Ä¢ –ú—è–≥–∫–æ:     if ($requests > 15) {
‚Ä¢ –°—Ä–µ–¥–Ω–µ:    if ($requests > 8) {
‚Ä¢ –°—Ç—Ä–æ–≥–æ:    if ($requests > 3) {

üõ°Ô∏è –ì–û–¢–û–í–´–ï –†–ï–ñ–ò–ú–´ –ó–ê–©–ò–¢–´

–û–ß–ï–ù–¨ –ú–Ø–ì–ö–ò–ô –†–ï–ñ–ò–ú (—Å–µ–º—å–∏, –æ—Ñ–∏—Å—ã, –æ–±—â–∏–π WiFi)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
$blockThreshold = $isMobile ? 50 : 40;
'ip_blocked' => 300,
'user_hash_blocked' => 900,
if ($trackingData['requests'] < 20) {
if ($requests > 20) {

–°–ë–ê–õ–ê–ù–°–ò–†–û–í–ê–ù–ù–´–ô –†–ï–ñ–ò–ú (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
$blockThreshold = $isMobile ? 35 : 25;
'ip_blocked' => 600,
'user_hash_blocked' => 1800,
if ($trackingData['requests'] < 8) {
if ($requests > 10) {

–°–¢–†–û–ì–ò–ô –†–ï–ñ–ò–ú (–≤—ã—Å–æ–∫–∞—è –∑–∞—â–∏—Ç–∞)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
$blockThreshold = $isMobile ? 20 : 15;
'ip_blocked' => 1800,
'user_hash_blocked' => 3600,
if ($trackingData['requests'] < 3) {
if ($requests > 5) {

‚ö° –ë–´–°–¢–†–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ß–ê–°–¢–´–• –ü–†–û–ë–õ–ï–ú

–ü—Ä–æ–±–ª–µ–º–∞: "–ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤—Å—è —Å–µ–º—å—è –Ω–∞ –æ–¥–Ω–æ–º IP"
–†–µ—à–µ–Ω–∏–µ: 
‚Ä¢ –£–≤–µ–ª–∏—á–∏—Ç—å $blockThreshold –¥–æ 40+
‚Ä¢ –£–º–µ–Ω—å—à–∏—Ç—å 'ip_blocked' –¥–æ 300 —Å–µ–∫
‚Ä¢ –£–±—Ä–∞—Ç—å $this->blockIP($ip); –≤ protect()

–ü—Ä–æ–±–ª–µ–º–∞: "–ú–æ–±–∏–ª—å–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã –±–ª–æ–∫–∏—Ä—É—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞"  
–†–µ—à–µ–Ω–∏–µ: ‚úÖ –£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û –≤ –∫–æ–¥–µ!
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è lastOctet IP –¥–ª—è —Ä–∞–∑–ª–∏—á–∏—è

–ü—Ä–æ–±–ª–µ–º–∞: "IP –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ"
–†–µ—à–µ–Ω–∏–µ:
‚Ä¢ –£–±—Ä–∞—Ç—å –≤—Å–µ $this->blockIP($ip);
‚Ä¢ –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ $this->blockUserHash();
‚Ä¢ –£–≤–µ–ª–∏—á–∏—Ç—å shouldAnalyzeIP –ø–æ—Ä–æ–≥–∏

–ü—Ä–æ–±–ª–µ–º–∞: "–ë–æ—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –∑–∞—â–∏—Ç—É"
–†–µ—à–µ–Ω–∏–µ:
‚Ä¢ –£–º–µ–Ω—å—à–∏—Ç—å $blockThreshold
‚Ä¢ –£–º–µ–Ω—å—à–∏—Ç—å –º–∏–Ω–∏–º—É–º –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å suspicious user agents

–ü—Ä–æ–±–ª–µ–º–∞: "–î–æ–ª–≥–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏"
–†–µ—à–µ–Ω–∏–µ:
‚Ä¢ 'ip_blocked' => 300,
‚Ä¢ 'user_hash_blocked' => 900,

üîß –ì–î–ï –ò–°–ö–ê–¢–¨ –í –ö–û–î–ï (inline_check.php)

‚îú‚îÄ‚îÄ analyzeUserHashBehavior()        ‚Üí –ø–æ—Ä–æ–≥–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ö–µ—à–µ–π
‚îú‚îÄ‚îÄ analyzeRequest()                 ‚Üí –ø–æ—Ä–æ–≥–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ IP  
‚îú‚îÄ‚îÄ shouldAnalyzeIP()               ‚Üí —É—Å–ª–æ–≤–∏—è –∞–Ω–∞–ª–∏–∑–∞ IP
‚îú‚îÄ‚îÄ generateUserHash()              ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ —Ö–µ—à–µ–π (–º–æ–±–∏–ª—å–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)
‚îú‚îÄ‚îÄ protect()                       ‚Üí –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞—â–∏—Ç—ã
‚îú‚îÄ‚îÄ ttlSettings                     ‚Üí –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
‚îî‚îÄ‚îÄ isSuspiciousUserAgent()         ‚Üí –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–æ—Ç–æ–≤

üîë –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò

–°–ï–ö–†–ï–¢–ù–´–ô –ö–õ–Æ–ß (–ö–†–ò–¢–ò–ß–ù–û!)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
private $secretKey = 'your_secret_key_here_change_this';

‚ö†Ô∏è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –°–ú–ï–ù–ò–¢–ï –ù–ê:
private $secretKey = '–≤–∞—à_—É–Ω–∏–∫–∞–ª—å–Ω—ã–π_–∫–ª—é—á_–º–∏–Ω–∏–º—É–º_32_—Å–∏–º–≤–æ–ª–∞_2025';

COOKIE –ù–ê–°–¢–†–û–ô–ö–ò
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
private $cookieName = 'visitor_verified';      // –ú–æ–∂–Ω–æ —Å–º–µ–Ω–∏—Ç—å
private $cookieLifetime = 86400 * 30;          // 30 –¥–Ω–µ–π, –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å

üìä –ù–û–í–´–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò v2.0

‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ —Ö–µ—à—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –º–æ–±–∏–ª—å–Ω—ã–µ —Ö–µ—à–∏ (—Ä–∞–∑–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã)
‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ TTL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ö–µ—à-–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–∞–¥ IP
‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
‚úÖ –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

‚ö†Ô∏è –û–ü–ê–°–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò (–ù–ï –¢–†–û–ì–ê–¢–¨ –ë–ï–ó –≠–ö–°–ü–ï–†–¢–ò–ó–´)

‚ùå –ù–ï –ò–ó–ú–ï–ù–Ø–ô–¢–ï:
‚Ä¢ –ü—Ä–µ—Ñ–∏–∫—Å—ã Redis –∫–ª—é—á–µ–π (bot_protection:, tracking: –∏ —Ç.–¥.)
‚Ä¢ –ê–ª–≥–æ—Ä–∏—Ç–º—ã —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è (hash('sha256', ...))
‚Ä¢ –õ–æ–≥–∏–∫—É isMobileDevice()
‚Ä¢ –ü–∞—Ç—Ç–µ—Ä–Ω—ã suspicious user agents
‚Ä¢ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ allowedSearchEngines
‚Ä¢ –°—Ç—Ä—É–∫—Ç—É—Ä—É generateUserHash() - —É–∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞!

üö® –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

‚Ä¢ –í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π—Ç–µ –ë–≠–ö–ê–ü –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
‚Ä¢ –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–∞–π—Ç–µ
‚Ä¢ –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ 24-48 —á–∞—Å–æ–≤ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
‚Ä¢ –ò–∑–º–µ–Ω—è–π—Ç–µ –ø–æ –û–î–ù–û–ú–£ –ø–∞—Ä–∞–º–µ—Ç—Ä—É –∑–∞ —Ä–∞–∑
‚Ä¢ –ù–∞—á–∏–Ω–∞–π—Ç–µ —Å –±–æ–ª–µ–µ –º—è–≥–∫–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

–õ–æ–≥–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫:
tail -f /var/log/apache2/error.log | grep "blocked"
tail -f /var/log/apache2/error.log | grep "Hash analysis"

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Redis:
redis-cli keys "bot_protection:*" | wc -l
redis-cli keys "bot_protection:user_hash:*" | wc -l

–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å v2.0:
https://–≤–∞—à-—Å–∞–π—Ç.com/dos/bot_protection/redis-admin.php

–¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã:
https://–≤–∞—à-—Å–∞–π—Ç.com/dos/bot_protection/redis_test.php

üéõÔ∏è –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –¢–ò–ü–£ –°–ê–ô–¢–ê

üì∞ –ù–û–í–û–°–¢–ù–û–ô –°–ê–ô–¢ (–∞–∫—Ç–∏–≤–Ω–æ–µ —á—Ç–µ–Ω–∏–µ)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
$blockThreshold = $isMobile ? 45 : 35;
'user_hash_blocked' => 900,
if ($trackingData['requests'] < 15) {

üõçÔ∏è –ò–ù–¢–ï–†–ù–ï–¢-–ú–ê–ì–ê–ó–ò–ù (–∏–∑—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
$blockThreshold = $isMobile ? 30 : 25;
'user_hash_blocked' => 1800,
if ($trackingData['requests'] < 8) {

üìù –ë–õ–û–ì/–ö–û–ù–¢–ï–ù–¢ (—Å—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã!

üîê API/SaaS (–æ—Å–æ–±—ã–µ –ø—Ä–∞–≤–∏–ª–∞)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∞

üéØ –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–° –°–ò–°–¢–ï–ú–´

–ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å–∏—Å—Ç–µ–º—ã:
‚úÖ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–æ—Ç—ã: —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ
‚úÖ –õ–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã  
‚úÖ –ú–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã: –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞

üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø –î–õ–Ø –ë–û–õ–¨–®–ò–ù–°–¢–í–ê –°–ê–ô–¢–û–í

–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞:
1. –°–º–µ–Ω–∏—Ç–µ secretKey
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º—è–≥–∫–∏–π —Ä–µ–∂–∏–º:
   $blockThreshold = $isMobile ? 40 : 30;
   'ip_blocked' => 600,
   'user_hash_blocked' => 1800,
3. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ 1-2 –Ω–µ–¥–µ–ª–∏
4. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

üÜò –ü–û–î–î–ï–†–ñ–ö–ê

–õ–æ–≥–∏: /var/log/apache2/error.log
–ê–¥–º–∏–Ω–∫–∞: redis-admin.php  
–¢–µ—Å—Ç—ã: redis_test.php
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: $protection->getStats()

–í–µ—Ä—Å–∏—è: v2.0
–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2025-07-05
–°—Ç–∞—Ç—É—Å: –°—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –º–æ–±–∏–ª—å–Ω—ã–º–∏ —Ö–µ—à–∞–º–∏
