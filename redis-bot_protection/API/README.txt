# iptables API - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π IP-–∞–¥—Ä–µ—Å–æ–≤

–ú–æ—â–Ω—ã–π –∏ –≥–∏–±–∫–∏–π REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏ IP-–∞–¥—Ä–µ—Å–æ–≤ —á–µ—Ä–µ–∑ iptables —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π IPv4/IPv6, –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#api-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
  - [Quick Start](#-quick-start-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
  - [cURL](#curl-linuxmac)
  - [Python](#python)
  - [PHP](#php)
  - [JavaScript](#javascript-nodejs)
  - [Bash](#bash-—Å–∫—Ä–∏–ø—Ç)
  - [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CMS](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-cms-–∏-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞–º–∏)
- [–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å](#–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- [–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏](#–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞-–Ω–∞–≥—Ä—É–∑–∫–∏)
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
  - [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-–ø–æ-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
  - [–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞—É–¥–∏—Ç](#–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏-–∞—É–¥–∏—Ç)
- [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)
- [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
- [FAQ](#-—á–∞—Å—Ç—ã–µ-–≤–æ–ø—Ä–æ—Å—ã-faq)
- [–ß–µ–∫–ª–∏—Å—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è](#-—á–µ–∫–ª–∏—Å—Ç-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è)
- [–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏](#-–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏)
- [–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ](#-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å-–∏-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã](#-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ-–º–∞—Ç–µ—Ä–∏–∞–ª—ã)
- [–õ–∏—Ü–µ–Ω–∑–∏—è](#-–ª–∏—Ü–µ–Ω–∑–∏—è)
- [–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –≤–∫–ª–∞–¥](#-–ø–æ–¥–¥–µ—Ä–∂–∫–∞-–∏-–≤–∫–ª–∞–¥)

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞** IPv4 –∏ IPv6 –∞–¥—Ä–µ—Å–æ–≤
- ‚úÖ **REST API** —Å JSON-–æ—Ç–≤–µ—Ç–∞–º–∏ (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ GET –∏ POST)
- ‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è POST** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ access.log
- ‚úÖ **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏
- ‚úÖ **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏** —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞** –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** –ø–æ API-–∫–ª—é—á—É
- ‚úÖ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Ä—Ç–æ–≤** 80 –∏ 443 (HTTP/HTTPS)
- ‚úÖ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —Å PHP 5.6 - 8.3
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –æ–ø–µ—Ä–∞—Ü–∏–π

---

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Linux** —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º iptables/ip6tables
- **PHP** 5.6 –∏–ª–∏ –≤—ã—à–µ
- **–í–µ–±-—Å–µ—Ä–≤–µ—Ä** (Nginx/Apache)
- **–ü—Ä–∞–≤–∞ sudo** –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞

### PHP —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

- `sysvsem` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è —Å–µ–º–∞—Ñ–æ—Ä–æ–≤)
- `json`
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è PHP

---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è API
mkdir -p /var/www/iptables-api
cd /var/www/iptables-api

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã
# - iptables.php (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç)
# - settings.php (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ñ–∞–π–ª–æ–≤
chown -R www-data:www-data /var/www/iptables-api

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã
chmod 644 iptables.php settings.php
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞

#### Nginx

```nginx
server {
    listen 80;
    server_name iptables-api.example.com;
    
    root /var/www/iptables-api;
    index iptables.php;
    
    location / {
        try_files $uri $uri/ /iptables.php?$query_string;
    }
    
    location ~ \.php$ {
        fastcgi_pass unix:/var/run/php/php8.1-fpm.sock;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }
}
```

#### Apache

```apache
<VirtualHost *:80>
    ServerName iptables-api.example.com
    DocumentRoot /var/www/iptables-api
    
    <Directory /var/www/iptables-api>
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ sudoers

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û**: –î–ª—è —Ä–∞–±–æ—Ç—ã API –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∞ sudo.

```bash
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ sudoers
sudo visudo -f /etc/sudoers.d/iptables-api
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `iptables` –≤ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª sudoers. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É –¥–ª—è –≤–∞—à–µ–≥–æ –≤–µ–±-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```bash
# –î–ª—è nginx
nginx ALL=(ALL) NOPASSWD: IPTABLES_IPV4, IPTABLES_IPV6, IPTABLES_INFO, IPTABLES_MISC, IPTABLES_SAVE, NGINX_RELOAD, IPTABLES_IPV4_ACCEPT, IPTABLES_IPV6_ACCEPT, IPTABLES_FULL_INFO

# –î–ª—è Apache (www-data)
www-data ALL=(ALL) NOPASSWD: IPTABLES_IPV4, IPTABLES_IPV6, IPTABLES_INFO, IPTABLES_MISC, IPTABLES_SAVE, NGINX_RELOAD, IPTABLES_IPV4_ACCEPT, IPTABLES_IPV6_ACCEPT, IPTABLES_FULL_INFO
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
sudo visudo -c -f /etc/sudoers.d/iptables-api

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
sudo -u www-data sudo /sbin/iptables -L INPUT -n
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–∞

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `settings.php`:

```php
// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π API –∫–ª—é—á
define('API_BLOCK_KEY', '–≤–∞—à-—Å–µ–∫—Ä–µ—Ç–Ω—ã–π-–∫–ª—é—á-–∑–¥–µ—Å—å');
```

**‚ö†Ô∏è –í–ê–ñ–ù–û**: 
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á! 
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ `settings.php` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏–º–µ—Ä –∫–ª—é—á–∞: `api-key-4567095@#$Agh`
- **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** —Å–º–µ–Ω–∏—Ç–µ –µ–≥–æ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!

**–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –∫–ª—é—á–∞**:

```bash
# –ú–µ—Ç–æ–¥ 1: OpenSSL (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
openssl rand -base64 32

# –ú–µ—Ç–æ–¥ 2: Random.org API
curl "https://www.random.org/strings/?num=1&len=32&digits=on&upperalpha=on&loweralpha=on&unique=on&format=plain"

# –ú–µ—Ç–æ–¥ 3: /dev/urandom
cat /dev/urandom | tr -dc 'a-zA-Z0-9!@#$%^&*()_+' | fold -w 32 | head -n 1
```

–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:
```
YmK9xP2vT4nW8zQ5jL7rH3cF6dS1aG0m
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏

–í `settings.php` –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

```php
// –í–∫–ª—é—á–∏—Ç—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –Ω–∞–≥—Ä—É–∑–∫–∏
define('LOAD_BALANCING_ENABLED', true);

// –ú–∞–∫—Å–∏–º—É–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 10-50)
define('MAX_CONCURRENT_REQUESTS', 20);

// –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥–∞—Ö (0 = –æ—Ç–∫–ª—é—á–µ–Ω–æ)
define('REQUEST_PROCESSING_DELAY', 0);

// –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ
define('DYNAMIC_DELAY_ENABLED', true);

// –ü–æ—Ä–æ–≥ –∑–∞–≥—Ä—É–∑–∫–∏ CPU –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∑–∞–¥–µ—Ä–∂–∫–∏
define('LOAD_THRESHOLD', 4.0);

// –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ (100000 –º–∫—Å = 0.1 —Å–µ–∫)
define('MAX_DYNAMIC_DELAY', 100000);
```

---

## üì° API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ë–∞–∑–æ–≤—ã–π URL

```
http://your-server/iptables.php
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ï—Å–ª–∏ –≤—ã —Ä–∞–∑–º–µ—Å—Ç–∏–ª–∏ API –≤ –ø–æ–¥–ø–∞–ø–∫–µ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å:
```
https://your-domain.com/dos/iptables.php
https://your-domain.com/api/iptables.php
https://your-domain.com/–∑–∞—â–∏—Ç–∞/iptables.php
```

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–í—Å–µ API –∑–∞–ø—Ä–æ—Å—ã —Ç—Ä–µ–±—É—é—Ç:
- –ü–∞—Ä–∞–º–µ—Ç—Ä `api=1`
- –ü–∞—Ä–∞–º–µ—Ç—Ä `api_key=–≤–∞—à-–∫–ª—é—á`

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–µ—Ç–æ–¥—ã –∑–∞–ø—Ä–æ—Å–æ–≤

API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–∞ –º–µ—Ç–æ–¥–∞:
- ‚úÖ **GET –∑–∞–ø—Ä–æ—Å—ã** - –ø—Ä–æ—Å—Ç—ã–µ –∏ –±—ã—Å—Ç—Ä—ã–µ
- ‚úÖ **POST –∑–∞–ø—Ä–æ—Å—ã** - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

**‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ POST –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ IP-–∞–¥—Ä–µ—Å–æ–≤, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è IP-–∞–¥—Ä–µ—Å–æ–≤ –≤ –ª–æ–≥–∞—Ö –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ (access.log). GET –∑–∞–ø—Ä–æ—Å—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –ª–æ–≥–∏, –≤–∫–ª—é—á–∞—è IP-–∞–¥—Ä–µ—Å–∞.

**–ü—Ä–∏–º–µ—Ä POST –∑–∞–ø—Ä–æ—Å–∞ (cURL)**:
```bash
curl -X POST "http://your-server/iptables.php" \
     -d "action=block" \
     -d "ip=192.168.1.100" \
     -d "api=1" \
     -d "api_key=–≤–∞—à-–∫–ª—é—á"
```

### Endpoints

#### 1. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP-–∞–¥—Ä–µ—Å–∞

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ë–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø —Å —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ IP-–∞–¥—Ä–µ—Å–∞ –Ω–∞ –ø–æ—Ä—Ç—ã 80 –∏ 443.

```http
GET /iptables.php?action=block&ip=192.168.1.100&api=1&api_key=–≤–∞—à-–∫–ª—é—á
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `action` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ): `block`
- `ip` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ): IP-–∞–¥—Ä–µ—Å –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (IPv4 –∏–ª–∏ IPv6)
- `api` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ): `1`
- `api_key` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ): –í–∞—à API –∫–ª—é—á

**–û—Ç–≤–µ—Ç (—É—Å–ø–µ—Ö)**:
```json
{
    "status": "success",
    "action": "block",
    "ip": "192.168.1.100",
    "message": "IP 192.168.1.100 —É—Å–ø–µ—à–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω",
    "details": "–ü–æ—Ä—Ç 80: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—Å–ø–µ—à–Ω–∞, –ü–æ—Ä—Ç 443: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—Å–ø–µ—à–Ω–∞",
    "ports": ["80", "443"],
    "timestamp": "2025-10-31 12:34:56"
}
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ)**:
```json
{
    "status": "success",
    "message": "IP-–∞–¥—Ä–µ—Å 192.168.1.100 —É—Å–ø–µ—à–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–ª—è –ø–æ—Ä—Ç–æ–≤ 80 –∏ 443",
    "details": "–ü–æ—Ä—Ç 80: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—Å–ø–µ—à–Ω–∞, –ü–æ—Ä—Ç 443: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—Å–ø–µ—à–Ω–∞"
}
```

**–û—Ç–≤–µ—Ç (—á–∞—Å—Ç–∏—á–Ω—ã–π —É—Å–ø–µ—Ö - –æ–¥–∏–Ω –ø–æ—Ä—Ç —É–∂–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω)**:
```json
{
    "status": "partial",
    "action": "block",
    "ip": "192.168.1.100",
    "message": "IP 192.168.1.100 —á–∞—Å—Ç–∏—á–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω",
    "details": "–ü–æ—Ä—Ç 80: –£–∂–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –ü–æ—Ä—Ç 443: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—Å–ø–µ—à–Ω–∞",
    "ports": ["443"],
    "timestamp": "2025-10-31 12:34:56"
}
```

#### 2. –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP-–∞–¥—Ä–µ—Å–∞

**–û–ø–∏—Å–∞–Ω–∏–µ**: –£–¥–∞–ª—è–µ—Ç –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ IP.

```http
GET /iptables.php?action=unblock&ip=192.168.1.100&api=1&api_key=–≤–∞—à-–∫–ª—é—á
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `action` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ): `unblock`
- `ip` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ): IP-–∞–¥—Ä–µ—Å –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- `api` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ): `1`
- `api_key` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ): –í–∞—à API –∫–ª—é—á

**–û—Ç–≤–µ—Ç (—É—Å–ø–µ—Ö)**:
```json
{
    "status": "success",
    "action": "unblock",
    "ip": "192.168.1.100",
    "message": "IP 192.168.1.100 —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω",
    "details": "–ü–æ—Ä—Ç 80: –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—Å–ø–µ—à–Ω–∞, –ü–æ—Ä—Ç 443: –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—Å–ø–µ—à–Ω–∞",
    "timestamp": "2025-10-31 12:35:12"
}
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ)**:
```json
{
    "status": "success",
    "message": "IP-–∞–¥—Ä–µ—Å 192.168.1.100 —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–ª—è –ø–æ—Ä—Ç–æ–≤ 80 –∏ 443",
    "details": "–ü–æ—Ä—Ç 80: –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—Å–ø–µ—à–Ω–∞, –ü–æ—Ä—Ç 443: –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—Å–ø–µ—à–Ω–∞"
}
```

#### 3. –°–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IPv4

**–û–ø–∏—Å–∞–Ω–∏–µ**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IPv4 –∞–¥—Ä–µ—Å–æ–≤.

```http
GET /iptables.php?action=list&api=1&api_key=–≤–∞—à-–∫–ª—é—á
```

**–û—Ç–≤–µ—Ç**:
```json
{
    "status": "success",
    "action": "list",
    "count": 3,
    "blocked_ips": [
        "192.168.1.100",
        "10.0.0.50",
        "172.16.0.10"
    ],
    "blocked_details": [
        {
            "ip": "192.168.1.100",
            "ports": ["80", "443"]
        },
        {
            "ip": "10.0.0.50",
            "ports": ["80", "443"]
        },
        {
            "ip": "172.16.0.10",
            "ports": ["80", "443"]
        }
    ],
    "timestamp": "2025-10-31 12:36:00"
}
```

#### 4. –°–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IPv6

**–û–ø–∏—Å–∞–Ω–∏–µ**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IPv6 –∞–¥—Ä–µ—Å–æ–≤.

```http
GET /iptables.php?action=list6&api=1&api_key=–≤–∞—à-–∫–ª—é—á
```

**–û—Ç–≤–µ—Ç**:
```json
{
    "status": "success",
    "action": "list6",
    "count": 2,
    "blocked_ips": [
        "2001:db8::1",
        "fe80::1"
    ],
    "blocked_details": [
        {
            "ip": "2001:db8::1",
            "ports": ["80", "443"]
        },
        {
            "ip": "fe80::1",
            "ports": ["80", "443"]
        }
    ],
    "timestamp": "2025-10-31 12:37:00"
}
```

#### 5. –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª

**–û–ø–∏—Å–∞–Ω–∏–µ**: –£–¥–∞–ª—è–µ—Ç –í–°–ï –ø—Ä–∞–≤–∏–ª–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ IPv4 –∏ IPv6.

```http
GET /iptables.php?action=clear&api=1&api_key=–≤–∞—à-–∫–ª—é—á
```

**‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï**: –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —É–¥–∞–ª–∏—Ç –≤—Å–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏!

**–û—Ç–≤–µ—Ç**:
```json
{
    "status": "success",
    "action": "clear",
    "message": "–í—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã",
    "removed_ipv4": 5,
    "removed_ipv6": 2,
    "timestamp": "2025-10-31 12:38:00"
}
```

#### 6. –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–û–ø–∏—Å–∞–Ω–∏–µ**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª–∞—Ö iptables.

```http
GET /iptables.php?action=debug&api=1&api_key=–≤–∞—à-–∫–ª—é—á
```

**–û—Ç–≤–µ—Ç**:
```json
{
    "status": "success",
    "action": "debug",
    "ipv4_rules": "...",
    "ipv6_rules": "...",
    "ipv4_verbose": "...",
    "ipv6_verbose": "...",
    "timestamp": "2025-10-31 12:39:00"
}
```

### –ö–æ–¥—ã –æ—à–∏–±–æ–∫

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏**:

```json
{
    "status": "error",
    "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
    "timestamp": "2025-10-31 12:40:00"
}
```

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏**:

| –û—à–∏–±–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏—á–∏–Ω–∞ |
|--------|----------|---------|
| `Invalid API key` | –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á | API –∫–ª—é—á –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–ª—é—á–æ–º –≤ settings.php |
| `IP address is required` | –ù–µ —É–∫–∞–∑–∞–Ω IP-–∞–¥—Ä–µ—Å | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `ip` –≤ –∑–∞–ø—Ä–æ—Å–µ |
| `Invalid IP address` | –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç IP | IP-–∞–¥—Ä–µ—Å –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç—É IPv4 –∏–ª–∏ IPv6 |
| `Action is required` | –ù–µ —É–∫–∞–∑–∞–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `action` –≤ –∑–∞–ø—Ä–æ—Å–µ |
| `Failed to block/unblock IP` | –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã | –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–∞–≤–∞–º–∏ sudo –∏–ª–∏ iptables |
| `IP —É–∂–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–ª—è –ø–æ—Ä—Ç–∞ X` | IP —É–∂–µ –≤ —Å–ø–∏—Å–∫–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ | –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —É–∂–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ IP |

**–ü—Ä–∏–º–µ—Ä—ã JSON –æ—Ç–≤–µ—Ç–æ–≤ —Å –æ—à–∏–±–∫–∞–º–∏**:

```json
// –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á
{
    "status": "error",
    "message": "–ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á",
    "timestamp": "2025-10-31 12:40:00"
}

// IP –∞–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω
{
    "status": "error",
    "message": "IP-–∞–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω",
    "timestamp": "2025-10-31 12:40:00"
}

// –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç IP
{
    "status": "error",
    "message": "–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç IP-–∞–¥—Ä–µ—Å–∞",
    "timestamp": "2025-10-31 12:40:00"
}

// IP —É–∂–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
{
    "status": "error",
    "message": "IP-–∞–¥—Ä–µ—Å 192.168.1.100 —É–∂–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–ª—è –ø–æ—Ä—Ç–∞ 80",
    "timestamp": "2025-10-31 12:40:00"
}
```

---

## üíª –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### üöÄ Quick Start (–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç)

–ï—Å–ª–∏ –≤—ã —Ç–æ–ª—å–∫–æ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ API –∏ —Ö–æ—Ç–∏—Ç–µ –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ–≥–æ —Ä–∞–±–æ—Ç—É:

**1. –£–∑–Ω–∞–π—Ç–µ –≤–∞—à API –∫–ª—é—á –∏–∑ `settings.php`**:
```bash
grep "API_BLOCK_KEY" settings.php
```

**2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ API (–∑–∞–º–µ–Ω–∏—Ç–µ `your-domain.com` –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω)**:

```bash
# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP
curl "https://your-domain.com/iptables.php?action=list&api=1&api_key=api-key-4567095@#$Agh"

# –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π IP
curl -X POST "https://your-domain.com/iptables.php" \
     -d "action=block" \
     -d "ip=1.2.3.4" \
     -d "api=1" \
     -d "api_key=api-key-4567095@#$Agh"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ IP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
curl "https://your-domain.com/iptables.php?action=list&api=1&api_key=api-key-4567095@#$Agh"

# –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å IP
curl -X POST "https://your-domain.com/iptables.php" \
     -d "action=unblock" \
     -d "ip=1.2.3.4" \
     -d "api=1" \
     -d "api_key=api-key-4567095@#$Agh"
```

**3. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ –±—Ä–∞—É–∑–µ—Ä–µ**:
```
https://your-domain.com/iptables.php
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ**: –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** —Å–º–µ–Ω–∏—Ç–µ API –∫–ª—é—á –Ω–∞ —Å–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π!

---

### cURL (Linux/Mac)

**GET –∑–∞–ø—Ä–æ—Å—ã (–ø—Ä–æ—Å—Ç—ã–µ)**:

**–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP**:
```bash
curl "http://your-server/iptables.php?action=block&ip=192.168.1.100&api=1&api_key=–≤–∞—à-–∫–ª—é—á"
```

**–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP**:
```bash
curl "http://your-server/iptables.php?action=unblock&ip=192.168.1.100&api=1&api_key=–≤–∞—à-–∫–ª—é—á"
```

**–°–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö**:
```bash
curl "http://your-server/iptables.php?action=list&api=1&api_key=–≤–∞—à-–∫–ª—é—á" | jq
```

**POST –∑–∞–ø—Ä–æ—Å—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)**:

**–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP —á–µ—Ä–µ–∑ POST**:
```bash
curl -X POST "http://your-server/iptables.php" \
     -d "action=block" \
     -d "ip=192.168.1.100" \
     -d "api=1" \
     -d "api_key=–≤–∞—à-–∫–ª—é—á"
```

**–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP —á–µ—Ä–µ–∑ POST**:
```bash
curl -X POST "http://your-server/iptables.php" \
     -d "action=unblock" \
     -d "ip=192.168.1.100" \
     -d "api=1" \
     -d "api_key=–≤–∞—à-–∫–ª—é—á"
```

**–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IPv6 —á–µ—Ä–µ–∑ POST**:
```bash
curl -X POST "http://your-server/iptables.php" \
     -d "action=block" \
     -d "ip=2001:0db8::1" \
     -d "api=1" \
     -d "api_key=–≤–∞—à-–∫–ª—é—á"
```

### Python

```python
import requests
import json

API_URL = "http://your-server/iptables.php"
API_KEY = "–≤–∞—à-–∫–ª—é—á"

def block_ip(ip_address, use_post=True):
    """–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP-–∞–¥—Ä–µ—Å–∞"""
    params = {
        'action': 'block',
        'ip': ip_address,
        'api': '1',
        'api_key': API_KEY
    }
    
    if use_post:
        # POST –∑–∞–ø—Ä–æ—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        response = requests.post(API_URL, data=params)
    else:
        # GET –∑–∞–ø—Ä–æ—Å
        response = requests.get(API_URL, params=params)
    
    return response.json()

def unblock_ip(ip_address, use_post=True):
    """–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP-–∞–¥—Ä–µ—Å–∞"""
    params = {
        'action': 'unblock',
        'ip': ip_address,
        'api': '1',
        'api_key': API_KEY
    }
    
    if use_post:
        response = requests.post(API_URL, data=params)
    else:
        response = requests.get(API_URL, params=params)
    
    return response.json()

def get_blocked_ips(version=4):
    """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP"""
    action = 'list6' if version == 6 else 'list'
    params = {
        'action': action,
        'api': '1',
        'api_key': API_KEY
    }
    response = requests.get(API_URL, params=params)
    return response.json()

def clear_all_rules():
    """–û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)"""
    params = {
        'action': 'clear',
        'api': '1',
        'api_key': API_KEY
    }
    response = requests.post(API_URL, data=params)
    return response.json()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
if __name__ == "__main__":
    # –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ POST (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
    result = block_ip("192.168.1.100", use_post=True)
    print(json.dumps(result, indent=2, ensure_ascii=False))
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ IPv4
    blocked = get_blocked_ips(version=4)
    print(f"–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ IPv4: {blocked['count']}")
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ IPv6
    blocked_v6 = get_blocked_ips(version=6)
    print(f"–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ IPv6: {blocked_v6['count']}")
    
    # –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
    result = unblock_ip("192.168.1.100", use_post=True)
    print(json.dumps(result, indent=2, ensure_ascii=False))
```

### PHP

```php
<?php

class IPTablesAPI {
    private $api_url;
    private $api_key;
    
    public function __construct($url, $key) {
        $this->api_url = $url;
        $this->api_key = $key;
    }
    
    public function blockIP($ip, $use_post = true) {
        return $this->makeRequest('block', $ip, $use_post);
    }
    
    public function unblockIP($ip, $use_post = true) {
        return $this->makeRequest('unblock', $ip, $use_post);
    }
    
    public function getBlockedIPs($version = 4) {
        $action = ($version == 6) ? 'list6' : 'list';
        return $this->makeRequest($action, null, false);
    }
    
    public function clearAll() {
        return $this->makeRequest('clear', null, true);
    }
    
    private function makeRequest($action, $ip = null, $use_post = false) {
        $params = [
            'action' => $action,
            'api' => '1',
            'api_key' => $this->api_key
        ];
        
        if ($ip) {
            $params['ip'] = $ip;
        }
        
        if ($use_post) {
            // POST –∑–∞–ø—Ä–æ—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)
            $options = [
                'http' => [
                    'method'  => 'POST',
                    'header'  => 'Content-type: application/x-www-form-urlencoded',
                    'content' => http_build_query($params)
                ]
            ];
            $context = stream_context_create($options);
            $response = file_get_contents($this->api_url, false, $context);
        } else {
            // GET –∑–∞–ø—Ä–æ—Å
            $url = $this->api_url . '?' . http_build_query($params);
            $response = file_get_contents($url);
        }
        
        return json_decode($response, true);
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
$api = new IPTablesAPI('http://your-server/iptables.php', '–≤–∞—à-–∫–ª—é—á');

// –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ POST (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
$result = $api->blockIP('192.168.1.100', true);
echo "–°—Ç–∞—Ç—É—Å: " . $result['status'] . "\n";
echo "–°–æ–æ–±—â–µ–Ω–∏–µ: " . $result['message'] . "\n";

// –°–ø–∏—Å–æ–∫ IPv4
$blocked = $api->getBlockedIPs(4);
echo "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ IPv4: " . $blocked['count'] . "\n";

// –°–ø–∏—Å–æ–∫ IPv6
$blocked_v6 = $api->getBlockedIPs(6);
echo "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ IPv6: " . $blocked_v6['count'] . "\n";

// –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ POST
$result = $api->unblockIP('192.168.1.100', true);
echo "–†–µ–∑—É–ª—å—Ç–∞—Ç: " . $result['message'] . "\n";

// –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä —Å –ø—Ä—è–º—ã–º –≤—ã–∑–æ–≤–æ–º
$api_key = '–≤–∞—à-–∫–ª—é—á';
$ip = '192.168.1.100';

// POST –∑–∞–ø—Ä–æ—Å
$data = http_build_query([
    'action' => 'block',
    'ip' => $ip,
    'api' => '1',
    'api_key' => $api_key
]);

$options = [
    'http' => [
        'method'  => 'POST',
        'header'  => 'Content-type: application/x-www-form-urlencoded',
        'content' => $data
    ]
];

$context = stream_context_create($options);
$response = file_get_contents('http://your-server/iptables.php', false, $context);
$result = json_decode($response, true);

if ($result['status'] === 'success') {
    echo "IP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ!\n";
} else {
    echo "–û—à–∏–±–∫–∞: " . $result['message'] . "\n";
}
?>
```

### JavaScript (Node.js)

```javascript
const axios = require('axios');

class IPTablesAPI {
    constructor(url, apiKey) {
        this.apiUrl = url;
        this.apiKey = apiKey;
    }
    
    async blockIP(ip, usePost = true) {
        return this.makeRequest('block', ip, usePost);
    }
    
    async unblockIP(ip, usePost = true) {
        return this.makeRequest('unblock', ip, usePost);
    }
    
    async getBlockedIPs(version = 4) {
        const action = version === 6 ? 'list6' : 'list';
        return this.makeRequest(action, null, false);
    }
    
    async clearAll() {
        return this.makeRequest('clear', null, true);
    }
    
    async makeRequest(action, ip = null, usePost = false) {
        const params = {
            action: action,
            api: '1',
            api_key: this.apiKey
        };
        
        if (ip) {
            params.ip = ip;
        }
        
        try {
            let response;
            
            if (usePost) {
                // POST –∑–∞–ø—Ä–æ—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)
                const formData = new URLSearchParams(params);
                response = await axios.post(this.apiUrl, formData, {
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    }
                });
            } else {
                // GET –∑–∞–ø—Ä–æ—Å
                response = await axios.get(this.apiUrl, { params });
            }
            
            return response.data;
        } catch (error) {
            console.error('API Error:', error.message);
            throw error;
        }
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
(async () => {
    const api = new IPTablesAPI('http://your-server/iptables.php', '–≤–∞—à-–∫–ª—é—á');
    
    try {
        // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ POST (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        const blockResult = await api.blockIP('192.168.1.100', true);
        console.log('–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞:', blockResult);
        
        // –°–ø–∏—Å–æ–∫ IPv4
        const blocked = await api.getBlockedIPs(4);
        console.log(`–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ IPv4: ${blocked.count} IP`);
        
        // –°–ø–∏—Å–æ–∫ IPv6
        const blockedV6 = await api.getBlockedIPs(6);
        console.log(`–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ IPv6: ${blockedV6.count} IP`);
        
        // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ POST
        const unblockResult = await api.unblockIP('192.168.1.100', true);
        console.log('–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞:', unblockResult);
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞:', error);
    }
})();

// –ü—Ä–∏–º–µ—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º fetch (–±—Ä–∞—É–∑–µ—Ä)
async function blockIPBrowser(ip) {
    const formData = new URLSearchParams({
        action: 'block',
        ip: ip,
        api: '1',
        api_key: '–≤–∞—à-–∫–ª—é—á'
    });
    
    try {
        const response = await fetch('http://your-server/iptables.php', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: formData
        });
        
        const data = await response.json();
        
        if (data.status === 'success') {
            console.log('IP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω:', data.message);
        } else {
            console.error('–û—à–∏–±–∫–∞:', data.message);
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞:', error);
    }
}
```

### Bash —Å–∫—Ä–∏–ø—Ç

```bash
#!/bin/bash

API_URL="http://your-server/iptables.php"
API_KEY="–≤–∞—à-–∫–ª—é—á"

# –§—É–Ω–∫—Ü–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ IP (GET)
block_ip_get() {
    local ip=$1
    curl -s "${API_URL}?action=block&ip=${ip}&api=1&api_key=${API_KEY}"
}

# –§—É–Ω–∫—Ü–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ IP (POST - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
block_ip_post() {
    local ip=$1
    curl -s -X POST "${API_URL}" \
         -d "action=block" \
         -d "ip=${ip}" \
         -d "api=1" \
         -d "api_key=${API_KEY}"
}

# –§—É–Ω–∫—Ü–∏—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ IP (GET)
unblock_ip_get() {
    local ip=$1
    curl -s "${API_URL}?action=unblock&ip=${ip}&api=1&api_key=${API_KEY}"
}

# –§—É–Ω–∫—Ü–∏—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ IP (POST - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
unblock_ip_post() {
    local ip=$1
    curl -s -X POST "${API_URL}" \
         -d "action=unblock" \
         -d "ip=${ip}" \
         -d "api=1" \
         -d "api_key=${API_KEY}"
}

# –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞
get_blocked_ips() {
    curl -s "${API_URL}?action=list&api=1&api_key=${API_KEY}" | jq
}

# –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ IPv6
get_blocked_ips_v6() {
    curl -s "${API_URL}?action=list6&api=1&api_key=${API_KEY}" | jq
}

# –ú–∞—Å—Å–æ–≤–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–∑ —Ñ–∞–π–ª–∞ (—á–µ—Ä–µ–∑ POST)
block_from_file() {
    local file=$1
    local count=0
    local success=0
    local failed=0
    
    while IFS= read -r ip; do
        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
        [[ -z "$ip" || "$ip" =~ ^#.*$ ]] && continue
        
        ((count++))
        echo -n "[$count] –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞: $ip ... "
        
        result=$(block_ip_post "$ip")
        status=$(echo "$result" | jq -r '.status')
        
        if [ "$status" = "success" ]; then
            echo "‚úì OK"
            ((success++))
        else
            message=$(echo "$result" | jq -r '.message')
            echo "‚úó –û–®–ò–ë–ö–ê: $message"
            ((failed++))
        fi
        
        # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
        sleep 0.1
    done < "$file"
    
    echo ""
    echo "–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: $count IP"
    echo "–£—Å–ø–µ—à–Ω–æ: $success"
    echo "–û—à–∏–±–æ–∫: $failed"
}

# –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª (—á–µ—Ä–µ–∑ POST)
clear_all_rules() {
    echo "‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ —É–¥–∞–ª–∏—Ç –í–°–ï –ø—Ä–∞–≤–∏–ª–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏!"
    read -p "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (yes/no): " confirm
    
    if [ "$confirm" = "yes" ]; then
        curl -s -X POST "${API_URL}" \
             -d "action=clear" \
             -d "api=1" \
             -d "api_key=${API_KEY}" | jq
    else
        echo "–û–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞"
    fi
}

# –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
show_stats() {
    echo "=== –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ ==="
    
    ipv4=$(curl -s "${API_URL}?action=list&api=1&api_key=${API_KEY}")
    ipv4_count=$(echo "$ipv4" | jq -r '.count')
    
    ipv6=$(curl -s "${API_URL}?action=list6&api=1&api_key=${API_KEY}")
    ipv6_count=$(echo "$ipv6" | jq -r '.count')
    
    total=$((ipv4_count + ipv6_count))
    
    echo "IPv4 –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: $ipv4_count"
    echo "IPv6 –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: $ipv6_count"
    echo "–í—Å–µ–≥–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: $total"
}

# –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
show_help() {
    cat << EOF
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 {–∫–æ–º–∞–Ω–¥–∞} [–ø–∞—Ä–∞–º–µ—Ç—Ä—ã]

–ö–æ–º–∞–Ω–¥—ã:
    block <IP>          –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å IP (—á–µ—Ä–µ–∑ POST)
    unblock <IP>        –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å IP (—á–µ—Ä–µ–∑ POST)
    list                –ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ IPv4
    list6               –ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ IPv6
    bulk <—Ñ–∞–π–ª>         –ú–∞—Å—Å–æ–≤–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–∑ —Ñ–∞–π–ª–∞
    clear               –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞
    stats               –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    help                –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É

–ü—Ä–∏–º–µ—Ä—ã:
    $0 block 192.168.1.100
    $0 unblock 192.168.1.100
    $0 list
    $0 bulk blocked_ips.txt
    $0 stats

EOF
}

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥
case "$1" in
    block)
        if [ -z "$2" ]; then
            echo "–û—à–∏–±–∫–∞: –£–∫–∞–∂–∏—Ç–µ IP-–∞–¥—Ä–µ—Å"
            echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 block <IP>"
            exit 1
        fi
        block_ip_post "$2" | jq
        ;;
    unblock)
        if [ -z "$2" ]; then
            echo "–û—à–∏–±–∫–∞: –£–∫–∞–∂–∏—Ç–µ IP-–∞–¥—Ä–µ—Å"
            echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 unblock <IP>"
            exit 1
        fi
        unblock_ip_post "$2" | jq
        ;;
    list)
        get_blocked_ips
        ;;
    list6)
        get_blocked_ips_v6
        ;;
    bulk)
        if [ -z "$2" ]; then
            echo "–û—à–∏–±–∫–∞: –£–∫–∞–∂–∏—Ç–µ —Ñ–∞–π–ª —Å–æ —Å–ø–∏—Å–∫–æ–º IP"
            echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 bulk <—Ñ–∞–π–ª>"
            exit 1
        fi
        if [ ! -f "$2" ]; then
            echo "–û—à–∏–±–∫–∞: –§–∞–π–ª '$2' –Ω–µ –Ω–∞–π–¥–µ–Ω"
            exit 1
        fi
        block_from_file "$2"
        ;;
    clear)
        clear_all_rules
        ;;
    stats)
        show_stats
        ;;
    help|--help|-h)
        show_help
        ;;
    *)
        echo "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞: $1"
        show_help
        exit 1
        ;;
esac
```

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç
nano iptables-manage.sh

# –°–¥–µ–ª–∞–π—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x iptables-manage.sh

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ
./iptables-manage.sh block 192.168.1.100
./iptables-manage.sh list
./iptables-manage.sh stats
./iptables-manage.sh bulk blocked_ips.txt
```

**–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏** (`blocked_ips.txt`):
```text
# –°–ø–∏—Å–æ–∫ IP –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
192.168.1.100
10.0.0.50
172.16.0.10

# IPv6 –∞–¥—Ä–µ—Å–∞ —Ç–æ–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è
2001:0db8::1
2001:0db8::2
```

---

## üñ•Ô∏è –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

API –≤–∫–ª—é—á–∞–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏.

### –î–æ—Å—Ç—É–ø –∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
http://your-server/iptables.php
```

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

1. **–í–∫–ª–∞–¥–∫–∞ "–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞"**:
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP-–∞–¥—Ä–µ—Å–æ–≤
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ IP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ë—ã—Å—Ç—Ä–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ IP
   - –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª

2. **–í–∫–ª–∞–¥–∫–∞ "–°–ø–∏—Å–æ–∫"**:
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IPv4 –∏ IPv6
   - –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—Ä—Ç–∞—Ö
   - –ö–Ω–æ–ø–∫–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ IP
   - –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤

3. **–í–∫–ª–∞–¥–∫–∞ "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"**:
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IPv4
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IPv6
   - –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
   - –ì—Ä–∞—Ñ–∏–∫–∏ (–≤ –ø–ª–∞–Ω–∞—Ö)

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç API –∫–ª—é—á –∏–∑ `settings.php`. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**: –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞:

```nginx
location /iptables.php {
    # –†–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö IP
    allow 192.168.1.0/24;
    deny all;
    
    # –ò–ª–∏ –±–∞–∑–æ–≤–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    auth_basic "Restricted Access";
    auth_basic_user_file /etc/nginx/.htpasswd;
}
```

---

## ‚ö° –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏

API –≤–∫–ª—é—á–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–ø—Ä–æ—Å–æ–≤.

### –ú–µ—Ö–∞–Ω–∏–∑–º—ã –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏

1. **–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**:
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ —Å–µ–º–∞—Ñ–æ—Ä—ã
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–µ—Ä–µ–¥—å –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
   - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `MAX_CONCURRENT_REQUESTS`

2. **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞**:
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
   - –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏
   - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `REQUEST_PROCESSING_DELAY`

3. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞**:
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–µ CPU
   - –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏
   - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `LOAD_THRESHOLD` –∏ `MAX_DYNAMIC_DELAY`

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä** (–º–æ—â–Ω–æ–µ –∂–µ–ª–µ–∑–æ, –Ω–∏–∑–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞):
```php
define('MAX_CONCURRENT_REQUESTS', 50);
define('REQUEST_PROCESSING_DELAY', 0);
define('DYNAMIC_DELAY_ENABLED', false);
```

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–µ—Ä–≤–µ—Ä** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏):
```php
define('MAX_CONCURRENT_REQUESTS', 20);
define('REQUEST_PROCESSING_DELAY', 0);
define('DYNAMIC_DELAY_ENABLED', true);
define('LOAD_THRESHOLD', 4.0);
```

**–°–ª–∞–±—ã–π —Å–µ—Ä–≤–µ—Ä** (—Å—Ç–∞—Ä–æ–µ –∂–µ–ª–µ–∑–æ, –≤—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞):
```php
define('MAX_CONCURRENT_REQUESTS', 10);
define('REQUEST_PROCESSING_DELAY', 50000);  // 50ms
define('DYNAMIC_DELAY_ENABLED', true);
define('LOAD_THRESHOLD', 2.0);
define('MAX_DYNAMIC_DELAY', 200000);  // 200ms
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–∏–∑ settings.php)

–ï—Å–ª–∏ –≤—ã –Ω–µ –∏–∑–º–µ–Ω—è–ª–∏ `settings.php`, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:

```php
// –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞
LOAD_BALANCING_ENABLED = true

// –ú–∞–∫—Å–∏–º—É–º 20 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
MAX_CONCURRENT_REQUESTS = 20

// –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞
REQUEST_PROCESSING_DELAY = 0

// –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞
DYNAMIC_DELAY_ENABLED = true

// –ü–æ—Ä–æ–≥ –Ω–∞–≥—Ä—É–∑–∫–∏ CPU
LOAD_THRESHOLD = 4.0

// –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ 100ms (100000 –º–∫—Å)
MAX_DYNAMIC_DELAY = 100000
```

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
- –ü—Ä–∏ –Ω–∞–≥—Ä—É–∑–∫–µ CPU < 4.0: –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–µ—Ç, –∑–∞–ø—Ä–æ—Å—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ
- –ü—Ä–∏ –Ω–∞–≥—Ä—É–∑–∫–µ CPU > 4.0: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–æ 100ms –¥–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ 20 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤: –Ω–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∂–¥—É—Ç –≤ –æ—á–µ—Ä–µ–¥–∏

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞–≥—Ä—É–∑–∫–∏

API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–∞–∂–¥—ã–µ 100 –∑–∞–ø—Ä–æ—Å–æ–≤:

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
tail -f /var/log/php-fpm/error.log | grep "API —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
API —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: 100 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫, –Ω–∞–≥—Ä—É–∑–∫–∞: 2.5
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ POST –≤–º–µ—Å—Ç–æ GET**:
   ```bash
   # ‚ùå –ü–õ–û–•–û: IP –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –ª–æ–≥–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
   curl "http://api.example.com/iptables.php?action=block&ip=192.168.1.100&api_key=secret"
   
   # ‚úÖ –•–û–†–û–®–û: –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞
   curl -X POST "http://api.example.com/iptables.php" \
        -d "action=block" \
        -d "ip=192.168.1.100" \
        -d "api_key=secret"
   ```
   
   **–ü—Ä–∏—á–∏–Ω–∞**: GET-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ª–æ–≥–∞—Ö –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ (access.log), —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ä–∞—Å–∫—Ä—ã—Ç–∏—é API-–∫–ª—é—á–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–ª–æ–∫–∏—Ä—É–µ–º—ã—Ö IP. POST-–∑–∞–ø—Ä–æ—Å—ã –ø–µ—Ä–µ–¥–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è.

2. **–ó–∞—â–∏—Ç–∞ API –∫–ª—é—á–∞**:
   ```bash
   # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ settings.php
   chmod 600 settings.php
   chown www-data:www-data settings.php
   ```

3. **HTTPS –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω**:
   - –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è API
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Let's Encrypt)
   - –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–π—Ç–µ HTTP –Ω–∞ HTTPS

4. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –ø–æ IP**:
   ```php
   // –í iptables.php —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ
   $enable_ip_restriction = true;
   $allowed_ips = array(
       '192.168.1.0/24',  // –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å
       '10.0.0.50'        // –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π IP
   );
   ```

5. **Firewall –ø—Ä–∞–≤–∏–ª–∞**:
   ```bash
   # –†–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ API —Ç–æ–ª—å–∫–æ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö IP
   iptables -A INPUT -p tcp --dport 80 -s 192.168.1.0/24 -j ACCEPT
   iptables -A INPUT -p tcp --dport 80 -j DROP
   ```

6. **Rate limiting** (Nginx):
   ```nginx
   limit_req_zone $binary_remote_addr zone=iptables_api:10m rate=10r/s;
   
   location /iptables.php {
       limit_req zone=iptables_api burst=20;
   }
   ```

7. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏**:
   ```bash
   # –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π
   tail -f /var/log/nginx/access.log | grep iptables.php
   ```

8. **–†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞**:
   - –ú–µ–Ω—è–π—Ç–µ API –∫–ª—é—á —Ä–∞–∑ –≤ –º–µ—Å—è—Ü
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª–æ–∂–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π
   - –•—Ä–∞–Ω–∏—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ —Ñ–∞–π–ª—ã
ls -la /var/www/iptables-api/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ sudoers
sudo -l -U www-data

# –¢–µ—Å—Ç –¥–æ—Å—Ç—É–ø–∞ –±–µ–∑ –∫–ª—é—á–∞ (–¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É)
curl "http://your-server/iptables.php?action=list&api=1"
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞—É–¥–∏—Ç

**–í–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**:

–î–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—á–∞–ª–æ `iptables.php`:
```php
// –í–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤
define('API_LOG_ENABLED', true);
define('API_LOG_FILE', '/var/log/iptables-api.log');

function logAPIRequest($action, $ip, $status, $message) {
    if (!defined('API_LOG_ENABLED') || !API_LOG_ENABLED) return;
    
    $log_entry = sprintf(
        "[%s] Action: %s | IP: %s | Status: %s | Message: %s | User IP: %s\n",
        date('Y-m-d H:i:s'),
        $action,
        $ip,
        $status,
        $message,
        getUserIP()
    );
    
    error_log($log_entry, 3, API_LOG_FILE);
}
```

**–°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –ª–æ–≥–æ–≤**:
```bash
# –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –ª–æ–≥–æ–≤
sudo touch /var/log/iptables-api.log
sudo chown www-data:www-data /var/log/iptables-api.log
sudo chmod 640 /var/log/iptables-api.log
```

**–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤**:
```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 –∑–∞–ø–∏—Å–µ–π
tail -n 50 /var/log/iptables-api.log

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f /var/log/iptables-api.log

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–µ–π—Å—Ç–≤–∏—é
grep "Action: block" /var/log/iptables-api.log

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
grep "Action: block" /var/log/iptables-api.log | wc -l
```

**–†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ (logrotate)**:
```bash
# –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo nano /etc/logrotate.d/iptables-api
```

```
/var/log/iptables-api.log {
    weekly
    rotate 4
    compress
    delaycompress
    missingok
    notifempty
    create 640 www-data www-data
}
```

---

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: "Permission denied" –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ iptables

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∞ sudo

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ sudoers
sudo visudo -c -f /etc/sudoers.d/iptables-api

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –æ—Ç –∏–º–µ–Ω–∏ –≤–µ–±-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
sudo -u www-data sudo /sbin/iptables -L
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Invalid API key"

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π API –∫–ª—é—á

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–ª—é—á –≤ settings.php
cat settings.php | grep API_BLOCK_KEY

# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–¥–∞–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á
curl "http://your-server/iptables.php?action=list&api=1&api_key=–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π-–∫–ª—é—á"
```

### –ü—Ä–æ–±–ª–µ–º–∞: IP –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞**: –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã iptables

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ–∫—É—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞
sudo iptables -L INPUT -n -v

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
tail -f /var/log/syslog | grep iptables

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Ç–ª–∞–¥–∫—É —á–µ—Ä–µ–∑ API
curl "http://your-server/iptables.php?action=debug&api=1&api_key=–≤–∞—à-–∫–ª—é—á"
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°–µ–º–∞—Ñ–æ—Ä—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

**–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ sysvsem

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
php -m | grep sysv

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (Ubuntu/Debian)
sudo apt-get install php-sysv
sudo systemctl restart php-fpm
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ API

**–ü—Ä–∏—á–∏–Ω–∞**: –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏–ª–∏ –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É —Å–µ—Ä–≤–µ—Ä–∞
uptime
top

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –≤ settings.php
# –£–≤–µ–ª–∏—á—å—Ç–µ MAX_CONCURRENT_REQUESTS –∏–ª–∏ —É–º–µ–Ω—å—à–∏—Ç–µ LOAD_THRESHOLD
```

### –ü—Ä–æ–±–ª–µ–º–∞: IPv6 –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞**: ip6tables –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ ip6tables
which ip6tables

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ (Ubuntu/Debian)
sudo apt-get install iptables

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ IPv6
sudo ip6tables -L INPUT -n -v
```

### –í–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–ª–∞–¥–∫–∏

–î–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º –≤–∫–ª—é—á–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

```php
// –í –Ω–∞—á–∞–ª–µ iptables.php –¥–æ–±–∞–≤—å—Ç–µ
error_reporting(E_ALL);
ini_set('display_errors', 1);
ini_set('log_errors', 1);
ini_set('error_log', '/tmp/iptables-api-debug.log');
```

–ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏:
```bash
tail -f /tmp/iptables-api-debug.log
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–∏—Ö –ø—Ä–∞–≤–∏–ª

```bash
# IPv4
sudo iptables -L INPUT -n -v | grep DROP

# IPv6
sudo ip6tables -L INPUT -n -v | grep DROP

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
sudo iptables -S INPUT | grep DROP | wc -l
```

### –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–∞–≤–∏–ª

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞ IPv4
sudo iptables-save > /etc/iptables/rules.v4

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞ IPv6
sudo ip6tables-save > /etc/iptables/rules.v6
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ iptables-persistent
sudo apt-get install iptables-persistent

# –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ systemd service
sudo nano /etc/systemd/system/iptables-restore.service
```

```ini
[Unit]
Description=Restore iptables rules
Before=network-pre.target

[Service]
Type=oneshot
ExecStart=/sbin/iptables-restore /etc/iptables/rules.v4
ExecStart=/sbin/ip6tables-restore /etc/iptables/rules.v6

[Install]
WantedBy=multi-user.target
```

```bash
sudo systemctl enable iptables-restore.service
```

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –í—ã –º–æ–∂–µ—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –∏–∑–º–µ–Ω—è—Ç—å –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å –∫–æ–¥ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∞–≤—Ç–æ—Ä—Å–∫–∏—Ö –ø—Ä–∞–≤–∞—Ö.

---

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–ª–µ–¥—É–µ—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –ø–æ [–£—Å—Ç–∞–Ω–æ–≤–∫–µ](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞) –∏ [–ù–∞—Å—Ç—Ä–æ–π–∫–µ](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
3. –í–∫–ª—é—á–∏—Ç–µ –æ—Ç–ª–∞–¥–∫—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ sudoers

---

## üîÑ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –í–µ—Ä—Å–∏—è 2.0
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ IPv6
- ‚úÖ –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –≤–∫–ª–∞–¥–∫–∞–º–∏
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—Ä—Ç–∞—Ö
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å PHP 5.6 - 8.3

### –í–µ—Ä—Å–∏—è 1.0
- ‚úÖ –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ IPv4
- ‚úÖ REST API —Å JSON-–æ—Ç–≤–µ—Ç–∞–º–∏
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

---

## ‚ùì FAQ (–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã)

### –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –±–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞?**  
A: –î–∞, API —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —É–¥–æ–±–Ω–∞—è –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

**Q: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª–∏ API –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ø–æ –¥—Ä—É–≥–∏–º –ø–æ—Ä—Ç–∞–º, –∫—Ä–æ–º–µ 80 –∏ 443?**  
A: –í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Ä—Ç—ã 80 (HTTP) –∏ 443 (HTTPS). –î–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥—Ä—É–≥–∏—Ö –ø–æ—Ä—Ç–æ–≤ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–¥–∞.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–ª—ã–µ –ø–æ–¥—Å–µ—Ç–∏?**  
A: –î–∞, –≤—ã –º–æ–∂–µ—Ç–µ —É–∫–∞–∑–∞—Ç—å CIDR –Ω–æ—Ç–∞—Ü–∏—é, –Ω–∞–ø—Ä–∏–º–µ—Ä: `192.168.1.0/24` –∏–ª–∏ `2001:db8::/32`

**Q: –ü–æ—á–µ–º—É —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å POST –≤–º–µ—Å—Ç–æ GET?**  
A: GET-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ª–æ–≥–∞—Ö –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —É—Ç–µ—á–∫–µ API-–∫–ª—é—á–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–ª–æ–∫–∏—Ä—É–µ–º—ã—Ö IP. POST –ø–µ—Ä–µ–¥–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è.

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã

**Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –ø–æ–ª—É—á–∞—é –æ—à–∏–±–∫—É "Permission denied"?**  
A: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ sudoers. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ (www-data, nginx) –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ iptables –±–µ–∑ –ø–∞—Ä–æ–ª—è.

**Q: –ü–æ—á–µ–º—É IP –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è, –Ω–æ —Å–∞–π—Ç –≤—Å–µ —Ä–∞–≤–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω?**  
A: –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
- IP –æ–±—Ä–∞—â–∞–µ—Ç—Å—è —Å –¥—Ä—É–≥–æ–≥–æ –∞–¥—Ä–µ—Å–∞ (—á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏/VPN)
- –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
- –ï—Å—Ç—å –¥—Ä—É–≥–∏–µ –ø—Ä–∞–≤–∏–ª–∞ ACCEPT, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ä–∞–Ω—å—à–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CDN (Cloudflare, etc.) - –±–ª–æ–∫–∏—Ä—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π IP, –∞ –Ω–µ IP CDN

**Q: –ö–∞–∫ —É–∑–Ω–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π IP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞ –ø—Ä–æ–∫—Å–∏/CDN?**  
A: API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ `X-Forwarded-For` –∏ `X-Real-IP`. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø–µ—Ä–µ–¥–∞—á—É —ç—Ç–∏—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤.

**Q: –°–∫–æ–ª—å–∫–æ IP –º–æ–∂–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ?**  
A: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–µ—Ç, –Ω–æ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª (>10000) –º–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª–∏—Ç—å —Ä–∞–±–æ—Ç—É iptables. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ipset –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤.

**Q: –ß—Ç–æ —Ç–∞–∫–æ–µ ipset –∏ –∫–∞–∫ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤?**  
A: ipset - —ç—Ç–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ iptables –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ —Å–ø–∏—Å–∫–∞–º–∏ IP. –í–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ IP, —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–¥–∏–Ω –Ω–∞–±–æ—Ä (set) –∏ –æ–¥–Ω–æ –ø—Ä–∞–≤–∏–ª–æ. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ:

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ ipset
sudo ipset create blocked_ips hash:ip

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ IP –≤ –Ω–∞–±–æ—Ä
sudo ipset add blocked_ips 192.168.1.100
sudo ipset add blocked_ips 10.0.0.50

# –°–æ–∑–¥–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –≤—Å–µ–≥–æ –Ω–∞–±–æ—Ä–∞
sudo iptables -I INPUT -m set --match-set blocked_ips src -j DROP

# –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–∞–±–æ—Ä–∞
sudo ipset list blocked_ips

# –£–¥–∞–ª–µ–Ω–∏–µ IP –∏–∑ –Ω–∞–±–æ—Ä–∞
sudo ipset del blocked_ips 192.168.1.100
```

–î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å API –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–¥–∞, –Ω–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±—É–¥–µ—Ç –≤ 10-100 —Ä–∞–∑ –ª—É—á—à–µ –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ —Ç—ã—Å—è—á IP.

**Q: –ö–∞–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏?**  
A: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `iptables-persistent`:
```bash
sudo apt-get install iptables-persistent
```
–ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ systemd service (—Å–º. —Ä–∞–∑–¥–µ–ª "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞").

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**Q: –ë–µ–∑–æ–ø–∞—Å–Ω–æ –ª–∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å API –∫–ª—é—á –≤ URL?**  
A: –ù–µ—Ç! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ POST-–∑–∞–ø—Ä–æ—Å—ã –∏ HTTPS –¥–ª—è –∑–∞—â–∏—Ç—ã API-–∫–ª—é—á–∞ –æ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ API –ø–æ IP?**  
A: –î–∞, –≤ `iptables.php` –µ—Å—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `$enable_ip_restriction` –∏ –º–∞—Å—Å–∏–≤ `$allowed_ips`. –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞.

**Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π IP?**  
A: –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É —á–µ—Ä–µ–∑ SSH —Å –¥—Ä—É–≥–æ–≥–æ IP –∏–ª–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å —Ö–æ—Å—Ç–∏–Ω–≥-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞, –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
sudo iptables -D INPUT -s –í–ê–®_IP -p tcp --dport 80 -j DROP
sudo iptables -D INPUT -s –í–ê–®_IP -p tcp --dport 443 -j DROP
```

**Q: –ù—É–∂–Ω–æ –ª–∏ –º–µ–Ω—è—Ç—å API –∫–ª—é—á —Ä–µ–≥—É–ª—è—Ä–Ω–æ?**  
A: –î–∞, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–µ–Ω—è—Ç—å –∫–ª—é—á —Ö–æ—Ç—è –±—ã —Ä–∞–∑ –≤ –º–µ—Å—è—Ü –∏–ª–∏ –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—é.

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**Q: –ö–∞–∫ API –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞?**  
A: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ. –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤. –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –≤–ª–∏—è–Ω–∏–µ –Ω–µ–∑–∞–º–µ—Ç–Ω–æ.

**Q: –ß—Ç–æ —Ç–∞–∫–æ–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞?**  
A: –ü—Ä–∏ –≤—ã—Å–æ–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–µ CPU (–≤—ã—à–µ `LOAD_THRESHOLD`) API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, –∑–∞—â–∏—â–∞—è —Å–µ—Ä–≤–µ—Ä –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏.

**Q: –°–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å API?**  
A: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ—â–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞. –° –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - –æ–∫–æ–ª–æ 20-50 RPS. –î–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º —É–≤–µ–ª–∏—á—å—Ç–µ `MAX_CONCURRENT_REQUESTS`.

**Q: –ù–∞—Å–∫–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ iptables?**  
A: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ (–æ–±—ã—á–Ω–æ < 100ms). –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã iptables –Ω–æ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –æ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ IP —Å—Ä–∞–∑—É –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è. –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –º–æ–≥—É—Ç –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –¥–æ –∏—Ö –∑–∞–∫—Ä—ã—Ç–∏—è.

**Q: –í–ª–∏—è–µ—Ç –ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∞–∫–µ—Ç–æ–≤?**  
A: –î–∞, –Ω–æ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –¥–æ ~1000 –ø—Ä–∞–≤–∏–ª. iptables –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –ª–∏–Ω–µ–π–Ω–æ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:
- –†–∞–∑–º–µ—â–∞–π—Ç–µ –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –≤ –Ω–∞—á–∞–ª–µ —Å–ø–∏—Å–∫–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ipset –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ >1000 IP (–≤ 10-100 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ)
- –ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –ø–æ –ø–æ–¥—Å–µ—Ç—è–º –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ

**Q: –ö–∞–∫–æ–≤–∞ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ CPU –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ API –∑–∞–ø—Ä–æ—Å–æ–≤?**  
A: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è. –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç <1% CPU –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö. –û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ - —ç—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ sudo iptables, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è –∑–∞ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã.

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å Fail2Ban?**  
A: –î–∞! –°–º. —Ä–∞–∑–¥–µ–ª "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã" ‚Üí "–ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏".

**Q: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ª–∏ —Ä–∞–±–æ—Ç–∞ —Å Docker?**  
A: –î–∞, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–±—Ä–æ—Å iptables –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–∞ —Ö–æ—Å—Ç –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `--network=host`.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö?**  
A: –î–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ API –Ω–∞ –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–µ—Ä –∏ —É–ø—Ä–∞–≤–ª—è–π—Ç–µ —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∏–ª–∏ —Å–∏—Å—Ç–µ–º—É –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏.

**Q: –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ API —Å Kubernetes?**  
A: –î–∞, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DaemonSet –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è API –Ω–∞ –∫–∞–∂–¥–æ–º —É–∑–ª–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ Kubernetes.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (Zabbix, Prometheus)?**  
A: –î–∞. API –º–æ–∂–Ω–æ –æ–ø—Ä–æ—Å–∏—Ç—å —á–µ—Ä–µ–∑ HTTP –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP, —Å—Ç–∞—Ç—É—Å). –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å webhook'–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

**Q: –ù–∞ –∫–∞–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç API?**  
A: Linux-—Å–∏—Å—Ç–µ–º—ã —Å iptables:
- ‚úÖ Ubuntu 18.04, 20.04, 22.04, 24.04
- ‚úÖ Debian 9, 10, 11, 12
- ‚úÖ CentOS 7, 8
- ‚úÖ RHEL 7, 8, 9
- ‚úÖ Rocky Linux 8, 9
- ‚úÖ AlmaLinux 8, 9
- ‚úÖ Fedora (–≤—Å–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏)

**Q: –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ API —Å nftables?**  
A: –ù–µ—Ç, API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç iptables/ip6tables. –î–ª—è nftables —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥. –û–¥–Ω–∞–∫–æ –º–Ω–æ–≥–∏–µ —Å–∏—Å—Ç–µ–º—ã —Å nftables –∏–º–µ—é—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ iptables-nft.

**Q: –ö–∞–∫–∏–µ –≤–µ—Ä—Å–∏–∏ PHP –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è?**  
A: PHP 5.6 - 8.3. API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª—Å—è –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –≤–µ—Ä—Å–∏—è—Ö (5.6, 7.0, 7.1, 7.2, 7.3, 7.4, 8.0, 8.1, 8.2, 8.3).

**Q: –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ API —Å Apache –≤–º–µ—Å—Ç–æ Nginx?**  
A: –î–∞, API —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–º, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å PHP. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ —Å:
- ‚úÖ Nginx + PHP-FPM
- ‚úÖ Apache + mod_php
- ‚úÖ Apache + PHP-FPM
- ‚úÖ LiteSpeed
- ‚úÖ Caddy

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã iptables

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª —Å –Ω–æ–º–µ—Ä–∞–º–∏ —Å—Ç—Ä–æ–∫
sudo iptables -L INPUT --line-numbers

# –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –ø–æ –Ω–æ–º–µ—Ä—É
sudo iptables -D INPUT 1

# –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª
sudo iptables -F INPUT

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
sudo iptables -P INPUT ACCEPT

# –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞
sudo iptables -A INPUT -p tcp --dport 22 -s 192.168.1.100 -j DROP

# –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ —Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
sudo iptables -A INPUT -i lo -j ACCEPT
```

### –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Fail2Ban**:
```bash
# /etc/fail2ban/action.d/iptables-api.conf
[Definition]
actionban = curl -X POST "http://your-server/iptables.php" -d "action=block" -d "ip=<ip>" -d "api=1" -d "api_key=–≤–∞—à-–∫–ª—é—á"
actionunban = curl -X POST "http://your-server/iptables.php" -d "action=unblock" -d "ip=<ip>" -d "api=1" -d "api_key=–≤–∞—à-–∫–ª—é—á"
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–∑ –ª–æ–≥–æ–≤**:
```bash
#!/bin/bash
# –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP
API_KEY="–≤–∞—à-–∫–ª—é—á"
API_URL="http://your-server/iptables.php"

tail -f /var/log/nginx/access.log | while read line; do
    if echo "$line" | grep -q "suspicious_pattern"; then
        IP=$(echo "$line" | awk '{print $1}')
        echo "–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ IP: $IP"
        curl -X POST "$API_URL" \
             -d "action=block" \
             -d "ip=$IP" \
             -d "api=1" \
             -d "api_key=$API_KEY" \
             --silent
    fi
done
```

**–ú–∞—Å—Å–æ–≤–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –∏–∑ —Å–ø–∏—Å–∫–∞**:
```bash
#!/bin/bash
# –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–ø–∏—Å–∫–∞ IP-–∞–¥—Ä–µ—Å–æ–≤ –∏–∑ —Ñ–∞–π–ª–∞
API_KEY="–≤–∞—à-–∫–ª—é—á"
API_URL="http://your-server/iptables.php"

# –§–∞–π–ª —Å IP –∞–¥—Ä–µ—Å–∞–º–∏ (–æ–¥–∏–Ω IP –Ω–∞ —Å—Ç—Ä–æ–∫—É)
IP_FILE="blocked_ips.txt"

while IFS= read -r IP; do
    # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
    [[ -z "$IP" || "$IP" == \#* ]] && continue
    
    echo "–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞: $IP"
    curl -X POST "$API_URL" \
         -d "action=block" \
         -d "ip=$IP" \
         -d "api=1" \
         -d "api_key=$API_KEY" \
         --silent
    
    # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ (–Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å —Å–µ—Ä–≤–µ—Ä)
    sleep 0.1
done < "$IP_FILE"

echo "–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è**:
```bash
#!/bin/bash
# –í—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –Ω–∞ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
API_KEY="–≤–∞—à-–∫–ª—é—á"
API_URL="http://your-server/iptables.php"
IP="$1"
DURATION="$2"  # –í —Å–µ–∫—É–Ω–¥–∞—Ö

if [ -z "$IP" ] || [ -z "$DURATION" ]; then
    echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 <IP> <–≤—Ä–µ–º—è_–≤_—Å–µ–∫—É–Ω–¥–∞—Ö>"
    exit 1
fi

echo "–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP $IP –Ω–∞ $DURATION —Å–µ–∫—É–Ω–¥..."
curl -X POST "$API_URL" \
     -d "action=block" \
     -d "ip=$IP" \
     -d "api=1" \
     -d "api_key=$API_KEY"

sleep "$DURATION"

echo "–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP $IP..."
curl -X POST "$API_URL" \
     -d "action=unblock" \
     -d "ip=$IP" \
     -d "api=1" \
     -d "api_key=$API_KEY"

echo "–ì–æ—Ç–æ–≤–æ!"
```

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ DDoS**:
```bash
#!/bin/bash
# –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
API_KEY="–≤–∞—à-–∫–ª—é—á"
API_URL="http://your-server/iptables.php"
LOG_FILE="/var/log/nginx/access.log"
THRESHOLD=100  # –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
CHECK_INTERVAL=60  # –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö

while true; do
    echo "–ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ $CHECK_INTERVAL —Å–µ–∫—É–Ω–¥..."
    
    # –ü–æ–ª—É—á–∞–µ–º IP —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–ø—Ä–æ—Å–æ–≤
    tail -n 10000 "$LOG_FILE" | \
    awk '{print $1}' | \
    sort | \
    uniq -c | \
    sort -rn | \
    while read count ip; do
        if [ "$count" -gt "$THRESHOLD" ]; then
            echo "‚ö†Ô∏è IP $ip —Å–¥–µ–ª–∞–ª $count –∑–∞–ø—Ä–æ—Å–æ–≤ (–ª–∏–º–∏—Ç: $THRESHOLD)"
            echo "–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ $ip..."
            
            curl -X POST "$API_URL" \
                 -d "action=block" \
                 -d "ip=$ip" \
                 -d "api=1" \
                 -d "api_key=$API_KEY" \
                 --silent
        fi
    done
    
    sleep "$CHECK_INTERVAL"
done
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CMS –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞–º–∏

**WordPress (–ø–ª–∞–≥–∏–Ω –∏–ª–∏ functions.php)**:
```php
<?php
// –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö –≤—Ö–æ–¥–∞
add_action('wp_login_failed', 'block_failed_login_ip');

function block_failed_login_ip($username) {
    $ip = $_SERVER['REMOTE_ADDR'];
    $attempts_key = 'login_attempts_' . $ip;
    $attempts = get_transient($attempts_key) ?: 0;
    $attempts++;
    
    set_transient($attempts_key, $attempts, 3600); // 1 —á–∞—Å
    
    if ($attempts >= 5) { // 5 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
        $api_key = '–≤–∞—à-–∫–ª—é—á';
        $api_url = 'https://your-server/iptables.php';
        
        wp_remote_post($api_url, array(
            'body' => array(
                'action' => 'block',
                'ip' => $ip,
                'api' => '1',
                'api_key' => $api_key
            )
        ));
        
        error_log("–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω IP: $ip –ø–æ—Å–ª–µ $attempts –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞");
    }
}
?>
```

**Laravel (Middleware)**:
```php
<?php
namespace App\Http\Middleware;

use Closure;
use Illuminate\Support\Facades\Http;
use Illuminate\Support\Facades\Cache;

class BlockSuspiciousIP
{
    public function handle($request, Closure $next)
    {
        $ip = $request->ip();
        $key = "requests_count_{$ip}";
        
        $count = Cache::get($key, 0);
        $count++;
        Cache::put($key, $count, now()->addMinutes(1));
        
        // –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –µ—Å–ª–∏ –±–æ–ª–µ–µ 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
        if ($count > 100) {
            $this->blockIP($ip);
            return response('Too Many Requests', 429);
        }
        
        return $next($request);
    }
    
    private function blockIP($ip)
    {
        Http::post(config('services.iptables.url'), [
            'action' => 'block',
            'ip' => $ip,
            'api' => '1',
            'api_key' => config('services.iptables.key')
        ]);
        
        \Log::warning("IP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: {$ip}");
    }
}
```

**Django (Middleware)**:
```python
import requests
from django.core.cache import cache
from django.http import HttpResponse

class IPBlockMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response
        self.api_url = 'https://your-server/iptables.php'
        self.api_key = '–≤–∞—à-–∫–ª—é—á'
        
    def __call__(self, request):
        ip = self.get_client_ip(request)
        cache_key = f'requests_{ip}'
        
        count = cache.get(cache_key, 0)
        count += 1
        cache.set(cache_key, count, 60)  # 60 —Å–µ–∫—É–Ω–¥
        
        if count > 100:  # –õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
            self.block_ip(ip)
            return HttpResponse('Too Many Requests', status=429)
        
        response = self.get_response(request)
        return response
    
    def get_client_ip(self, request):
        x_forwarded_for = request.META.get('HTTP_X_FORWARDED_FOR')
        if x_forwarded_for:
            ip = x_forwarded_for.split(',')[0]
        else:
            ip = request.META.get('REMOTE_ADDR')
        return ip
    
    def block_ip(self, ip):
        try:
            requests.post(self.api_url, data={
                'action': 'block',
                'ip': ip,
                'api': '1',
                'api_key': self.api_key
            })
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ {ip}: {e}")
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —á–µ–∫–ª–∏—Å—Ç –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è API:

### –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- [ ] –§–∞–π–ª—ã `iptables.php` –∏ `settings.php` –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- [ ] –ü—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (644 –¥–ª—è PHP —Ñ–∞–π–ª–æ–≤)
- [ ] –í–ª–∞–¥–µ–ª–µ—Ü —Ñ–∞–π–ª–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
- [ ] –í–µ–±-—Å–µ—Ä–≤–µ—Ä (Nginx/Apache) –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ sudo
- [ ] –§–∞–π–ª sudoers —Å–æ–∑–¥–∞–Ω –≤ `/etc/sudoers.d/iptables-api`
- [ ] –ü—Ä–∞–≤–∞ sudo –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ (nginx/www-data)
- [ ] –°–∏–Ω—Ç–∞–∫—Å–∏—Å sudoers –ø—Ä–æ–≤–µ—Ä–µ–Ω –∫–æ–º–∞–Ω–¥–æ–π `visudo -c`
- [ ] –†–∞–±–æ—Ç–∞ sudo –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- [ ] API –∫–ª—é—á –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä!)
- [ ] API –∫–ª—é—á —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ
- [ ] HTTPS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç (SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
- [ ] –î–æ—Å—Ç—É–ø –∫ API –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –ø–æ IP (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω rate limiting –≤ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–µ
- [ ] –§–∞–π–ª `settings.php` –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ 600 (—Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] API —É—Å–ø–µ—à–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞
- [ ] –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ IP —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ IP —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å IPv6 (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –§–∞–π–ª –ª–æ–≥–æ–≤ —Å–æ–∑–¥–∞–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ü—Ä–∞–≤–∏–ª–∞ iptables —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- [ ] –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

---

## üéØ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API –∫–ª—é—á–∞–º–∏
```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –∫–ª—é—á–∞
openssl rand -base64 48

# –•—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (–±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ)
export IPTABLES_API_KEY="–≤–∞—à-—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π-–∫–ª—é—á"

# –í PHP –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ $_ENV –≤–º–µ—Å—Ç–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
$api_key = getenv('IPTABLES_API_KEY') ?: 'fallback-key';
```

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª
```bash
#!/bin/bash
# /usr/local/bin/iptables-backup.sh

BACKUP_DIR="/var/backups/iptables"
DATE=$(date +%Y%m%d_%H%M%S)

mkdir -p "$BACKUP_DIR"

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª
iptables-save > "$BACKUP_DIR/rules.v4.$DATE"
ip6tables-save > "$BACKUP_DIR/rules.v6.$DATE"

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
find "$BACKUP_DIR" -name "rules.*" -mtime +30 -delete

echo "–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞–Ω–∞: $DATE"
```

–î–æ–±–∞–≤—å—Ç–µ –≤ crontab:
```bash
# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00
0 3 * * * /usr/local/bin/iptables-backup.sh
```

### 3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö
```bash
#!/bin/bash
# –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ IP

API_KEY="–≤–∞—à-–∫–ª—é—á"
TELEGRAM_BOT_TOKEN="your-bot-token"
TELEGRAM_CHAT_ID="your-chat-id"

# –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram
send_telegram() {
    local message="$1"
    curl -s -X POST "https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage" \
         -d "chat_id=${TELEGRAM_CHAT_ID}" \
         -d "text=${message}" \
         -d "parse_mode=HTML"
}

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
tail -f /var/log/iptables-api.log | while read line; do
    if echo "$line" | grep -q "Action: block"; then
        IP=$(echo "$line" | grep -oP 'IP: \K[^\s]+')
        send_telegram "üö´ <b>–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω IP:</b> <code>$IP</code>"
    fi
done
```

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è API
```bash
#!/bin/bash
# /usr/local/bin/iptables-api-healthcheck.sh

API_URL="https://your-server/iptables.php"
API_KEY="–≤–∞—à-–∫–ª—é—á"
ALERT_EMAIL="admin@example.com"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
response=$(curl -s -o /dev/null -w "%{http_code}" "${API_URL}?action=list&api=1&api_key=${API_KEY}")

if [ "$response" != "200" ]; then
    echo "‚ö†Ô∏è API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω! HTTP –∫–æ–¥: $response" | \
    mail -s "Iptables API Alert" "$ALERT_EMAIL"
    exit 1
fi

echo "‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ"
```

–î–æ–±–∞–≤—å—Ç–µ –≤ crontab:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
*/5 * * * * /usr/local/bin/iptables-api-healthcheck.sh
```

### 5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
```bash
#!/bin/bash
# –£–¥–∞–ª–µ–Ω–∏–µ IP, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–æ–ª–µ–µ 24 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥

API_URL="https://your-server/iptables.php"
API_KEY="–≤–∞—à-–∫–ª—é—á"
MAX_AGE_HOURS=24

# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP
blocked_ips=$(curl -s "${API_URL}?action=list&api=1&api_key=${API_KEY}" | \
              jq -r '.blocked_ips[]')

# –ó–¥–µ—Å—å –Ω—É–∂–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
# (—Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏)

for ip in $blocked_ips; do
    # –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
    # –ï—Å–ª–∏ —Å—Ç–∞—Ä—à–µ MAX_AGE_HOURS - —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
    echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ IP: $ip"
done
```

### 6. –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏
```python
#!/usr/bin/env python3
# multi-server-block.py - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö

import requests
import concurrent.futures

SERVERS = [
    {'url': 'https://server1.com/iptables.php', 'key': 'key1'},
    {'url': 'https://server2.com/iptables.php', 'key': 'key2'},
    {'url': 'https://server3.com/iptables.php', 'key': 'key3'},
]

def block_ip_on_server(server, ip):
    """–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ"""
    try:
        response = requests.post(server['url'], data={
            'action': 'block',
            'ip': ip,
            'api': '1',
            'api_key': server['key']
        }, timeout=5)
        
        result = response.json()
        return {
            'server': server['url'],
            'status': result.get('status'),
            'message': result.get('message')
        }
    except Exception as e:
        return {
            'server': server['url'],
            'status': 'error',
            'message': str(e)
        }

def block_ip_everywhere(ip):
    """–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ"""
    with concurrent.futures.ThreadPoolExecutor(max_workers=10) as executor:
        futures = [executor.submit(block_ip_on_server, server, ip) 
                   for server in SERVERS]
        results = [f.result() for f in concurrent.futures.as_completed(futures)]
    
    return results

if __name__ == "__main__":
    ip_to_block = "192.168.1.100"
    print(f"–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ {ip_to_block} –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö...")
    
    results = block_ip_everywhere(ip_to_block)
    
    for result in results:
        print(f"–°–µ—Ä–≤–µ—Ä: {result['server']}")
        print(f"–°—Ç–∞—Ç—É—Å: {result['status']}")
        print(f"–°–æ–æ–±—â–µ–Ω–∏–µ: {result['message']}\n")
```

---

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ë–µ–Ω—á–º–∞—Ä–∫–∏

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: Intel Xeon E5-2680 v4, 32GB RAM, SSD, Ubuntu 22.04

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ | 50-150 –º—Å |
| –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (RPS) | 20-50 (—Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π) |
| –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (–±–µ–∑ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏) | 100-200 (—Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ) |
| –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª (–±–µ–∑ –∑–∞–º–µ–¥–ª–µ–Ω–∏—è) | ~5,000 |
| –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª (—Å ipset) | 100,000+ |
| –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ RAM | ~10-20 MB |
| –ù–∞–≥—Ä—É–∑–∫–∞ CPU (–ø—Ä–∏ 20 RPS) | <5% |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é

**–î–ª—è –º–∞–ª—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ (< 100 –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫)**:
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç–ª–∏—á–Ω–æ
- –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞

**–î–ª—è —Å—Ä–µ–¥–Ω–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ (100-1000 –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫)**:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –Ω–∞–≥—Ä—É–∑–∫–∏
- –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ipset –ø—Ä–∏ >500 IP

**–î–ª—è –∫—Ä—É–ø–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ (> 1000 –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫)**:
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ipset
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –≤ –ø–∞–º—è—Ç–∏
- –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
- –í–Ω–µ–¥—Ä–∏—Ç–µ –æ—á–µ—Ä–µ–¥—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è iptables](https://www.netfilter.org/documentation/)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ ipset](https://ipset.netfilter.org/)
- [–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Linux](https://www.cisecurity.org/cis-benchmarks/)
- [REST API Design Best Practices](https://restfulapi.net/)

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –í—ã –º–æ–∂–µ—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –∏–∑–º–µ–Ω—è—Ç—å –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å –∫–æ–¥ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∞–≤—Ç–æ—Ä—Å–∫–∏—Ö –ø—Ä–∞–≤–∞—Ö.

```
MIT License

Copyright (c) 2025 iptables API Project

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

---

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –≤–∫–ª–∞–¥

### –ù–∞—à–ª–∏ –±–∞–≥ –∏–ª–∏ –µ—Å—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ?

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [—Ä–∞–∑–¥–µ–ª FAQ](#-—á–∞—Å—Ç—ã–µ-–≤–æ–ø—Ä–æ—Å—ã-faq) - –≤–æ–∑–º–æ–∂–Ω–æ, –æ—Ç–≤–µ—Ç —É–∂–µ –µ—Å—Ç—å
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–ª–µ–¥–æ–≤–∞–ª–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
3. –í–∫–ª—é—á–∏—Ç–µ –æ—Ç–ª–∞–¥–∫—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
4. –°–æ–∑–¥–∞–π—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å:
   - –í–µ—Ä—Å–∏–µ–π PHP –∏ –û–°
   - –®–∞–≥–∞–º–∏ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
   - –¢–µ–∫—Å—Ç–æ–º –æ—à–∏–±–æ–∫ –∏–∑ –ª–æ–≥–æ–≤
   - –°–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)

### –•–æ—Ç–∏—Ç–µ –ø–æ–º–æ—á—å –ø—Ä–æ–µ–∫—Ç—É?

–ú—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º –≤–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç:
- üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–æ–≤
- ‚ú® –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- üìù –£–ª—É—á—à–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- üåç –ü–µ—Ä–µ–≤–æ–¥—ã –Ω–∞ –¥—Ä—É–≥–∏–µ —è–∑—ã–∫–∏
- üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç—á–µ—Ç—ã –æ —Ä–∞–±–æ—Ç–µ

### Roadmap (–ø–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è)

- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥—Ä—É–≥–∏—Ö –ø–æ—Ä—Ç–æ–≤ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ipset –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- [ ] GraphQL API
- [ ] WebSocket –¥–ª—è real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- [ ] Dashboard —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞—Ç–∞–∫
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–µ–ª—ã—Ö —Å–ø–∏—Å–∫–æ–≤ (whitelisting)
- [ ] –ì–µ–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ–±–ª–∞—á–Ω—ã–º–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏ (AWS, GCP, Azure)
- [ ] –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## üåü –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

–°–ø–∞—Å–∏–±–æ –≤—Å–µ–º, –∫—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç —ç—Ç–æ—Ç API!

–û—Å–æ–±–∞—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å:
- –ö–æ–º–∞–Ω–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ iptables/netfilter
- –°–æ–æ–±—â–µ—Å—Ç–≤—É Linux –∑–∞ –æ—Ç–ª–∏—á–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- –í—Å–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫–∞–º –∏ –∫–æ–Ω—Ç—Ä–∏–±—å—é—Ç–æ—Ä–∞–º

---

**–ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ!** üöÄ

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å - –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å!
